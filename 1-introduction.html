<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
	<meta charset="utf-8"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>üëã 1 Introduction &mdash; OpenXR Tutorial  documentation</title>
	<link rel="stylesheet" href="_static/pygments.css" type="text/css">
	<link rel="stylesheet" href="_static/css/theme.css" type="text/css">
	<link rel="shortcut icon" href="_static/favicon.ico">
	<!--[if lt IE 9]>
	  <script src="_static/js/html5shiv.min.js"></script>
	<![endif]-->
	
	<script src="_static/jquery.js"></script>
	<script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
	<script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
	<script src="_static/doctools.js"></script>
	<script src="_static/sphinx_highlight.js"></script>
	<script src="https://unpkg.com/mermaid@9.4.0/dist/mermaid.min.js"></script>
	<script>mermaid.initialize({startOnLoad:true});</script>
	<script src="_static/js/theme.js"></script>
	<link rel="index" title="Index" href="genindex.html" >
	<link rel="search" title="Search" href="search.html" >
	<link rel="next" title="‚öôÔ∏è 2 Setup" href="2-setup.html" >
	<link rel="prev" title="OpenXR Tutorial" href="index.html" > 
	<script  src="_static/js/js.cookie.min.js"></script>
	<script >
	function updatePlatform()
	{
	var platform = Cookies.get("platform");
	console.log("updatePlatform(), platform = " + platform);
	if (typeof platform == 'undefined')
	{
		platform = "windows"; // Set default here.
	}
	$(".linux").hide();
	$(".android").hide();
	$(".windows").hide();
	if (platform == "windows")
	{
		$(".windows").show();
		$(".selectd3d11").disabled = false;
		$(".selectd3d12").disabled = false;
		$(".selectopengles").disabled = true;
		$(".selectvulkan").disabled = false;
		$(".selectopengl").disabled = false;
	}
	if (platform == "linux")
	{
		$(".linux").show();
		$(".selectd3d11").disabled = true;
		$(".selectd3d12").disabled = true;
		$(".selectopengles").disabled = true;
		$(".selectvulkan").disabled = false;
		$(".selectopengl").disabled = false;
	}
	if (platform == "android")
	{
		$(".android").show();
		$(".selectd3d11").disabled = true;
		$(".selectd3d12").disabled = true;
		$(".selectopengles").disabled = false;
		$(".selectvulkan").disabled = false;
		$(".selectopengl").disabled = true;
	}
	var oldelements = document.querySelectorAll(".selected-platform");
	console.log("selected-platform on "+oldelements.length+" elements.");
	while (oldelements.length > 0)
	{
		var el=oldelements.item(0);
		el.classList.remove('selected-platform');
		console.log("Removing selected-platform from "+el.id);
		oldelements = document.querySelectorAll(".selected-platform");
	}
	var element = document.getElementById('select' + platform);
	if(element)
	{
		element.classList.add('selected-platform');
		console.log("Adding selected-platform to "+element.id);
	}
	var element2 = document.getElementById('select' + platform + "-inline");
	if(element2)
	{
		element2.classList.add('selected-platform');
		console.log("Adding selected-platform to "+element2.id);
	}
	else
	{
		console.log('select' + platform + "-inline not found");
	}
	if(limitAPIChoice())
		updateGraphicsAPI();
	window.updatePlatform=updatePlatform;
	}
	
	function limitAPIChoice()
	{
		var platform = Cookies.get("platform");
		var graphicsApi = Cookies.get("graphicsapi")
		console.log("limitAPIChoice(), platform = " + platform+", graphicsApi = "+graphicsApi);
		window.limitAPIChoice=limitAPIChoice;
		var newApi=graphicsApi;
		if (platform == "windows")
		{
			if (graphicsApi == "opengles"||graphicsApi==undefined)
				newApi="d3d11";
		}
		if (platform == "linux")
		{
			if (graphicsApi == "opengles"||graphicsApi=="d3d11"||graphicsApi=="d3d12"||graphicsApi==undefined)
				newApi="vulkan";
		}
		if (platform == "android"||graphicsApi==undefined)
		{
			if (graphicsApi != "opengles"&&graphicsApi!="vulkan")
				newApi="vulkan";
		}
		console.log("newApi = "+newApi);
		if (newApi != graphicsApi)
		{
			console.log("setting graphicsapi = "+newApi);
			Cookies.set('graphicsapi', newApi,{ expires: 365})
			graphicsApi=newApi;
			return true;
		}
		return false;
	}
	function makeLinksOpenInNewWindow()
	{ 
		console.log("makeLinksOpenInNewWindow ");
		var download_hrefs = document.getElementsByClassName('reference download internal');
		[].forEach.call(download_hrefs, function(el) {
			el.setAttribute('target', "_blank");
			console.log("Adding target blank to "+el.id);
		});
		link_hrefs = document.getElementsByClassName('reference external');
		[].forEach.call(link_hrefs, function(el) {
			el.setAttribute('target', "_blank");
			console.log("Adding target blank to "+el.id);
		});
		window.makeLinksOpenInNewWindow=makeLinksOpenInNewWindow;
	}
	function updateGraphicsAPI()
	{
		var graphicsApi = Cookies.get("graphicsapi")
		console.log("graphicsapi = " + graphicsApi);
		if (typeof graphicsApi == 'undefined')
		{
			graphicsApi = "vulkan"; // Set default here.
		}
		// first, hide all the api's
		$(".d3d11").hide();
		$(".d3d12").hide();
		$(".opengl").hide();
		$(".opengles").hide();
		$(".vulkan").hide();
		// Now, show the wanted api's. In this way, divs with more than one will be shown, even if they have one that is hidden.
		if (graphicsApi == "d3d11") {
			$(".d3d11").show();
		}
		if (graphicsApi == "d3d12") {
			$(".d3d12").show();
		}
		if (graphicsApi == "opengl") {
			$(".opengl").show();
		}
		if (graphicsApi == "opengles") {
			$(".opengles").show();
		}
		if (graphicsApi == "vulkan") {
			$(".vulkan").show();
		}
		var oldelements = document.querySelectorAll(".selected-graphics-api");
		console.log("selected-platform on "+oldelements.length+" elements.");
		while (oldelements.length > 0)
		{
			var el=oldelements.item(0);
			el.classList.remove('selected-graphics-api');
			console.log("Removing selected-graphics-api from "+el.id);
			oldelements = document.querySelectorAll(".selected-graphics-api");
		}
		var element = document.getElementById('select' + graphicsApi);
		if(element)
		{
			element.classList.add('selected-graphics-api');
		}
		var element2 = document.getElementById('select' + graphicsApi +"-inline");
		if (element2)
		{
			element2.classList.add('selected-graphics-api');
		}
		window.updateGraphicsAPI=updateGraphicsAPI;
	}</script>
	<script >
	var graphicsApi = Cookies.get("graphicsapi")
	if (graphicsApi==undefined) {
		Cookies.set('graphicsapi', 'vulkan',{ expires: 365})
		graphicsApi='vulkan';
	}
	</script>
	<style>
	@import url('https://fonts.googleapis.com/css2?family=Poppins&display=swap');
	@import url('https://fonts.cdnfonts.com/css/menlo');
	</style>
</head>

<body class="wy-body-for-nav" onload="updatePlatform(); updateGraphicsAPI(); makeLinksOpenInNewWindow();"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
			<a href="index.html"  class="" >
				<img src="_static/OpenXR_170px_Feb17.png" class="logo" alt="The OpenXR logo" >
				
				<span class="sidebartitle">
					Tutorial
				</span>
				
			</a>
<div role="search">
    <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
        <label class="search-label" for="q">Search the tutorial</label>
        <input type="text" name="q" id="q" placeholder="Search..." aria-label="Search docs">
        <input type="hidden" name="check_keywords" value="yes">
        <input type="hidden" name="area" value="default">
    </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">üëã 1 Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#goal-of-openxr">1.1 Goal of OpenXR</a></li>
<li class="toctree-l2"><a class="reference internal" href="#overview">1.2 Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-up">1.3 Setting Up</a></li>
<li class="toctree-l2"><a class="reference internal" href="#project-setup">1.4 Project Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cmake-and-project-files">1.4.1 CMake and Project Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#common-files">1.4.2 Common Files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#debugoutput">DebugOutput</a></li>
<li class="toctree-l4"><a class="reference internal" href="#helperfunctions">HelperFunctions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#openxrdebugutils">OpenXRDebugUtils</a></li>
<li class="toctree-l4"><a class="reference internal" href="#openxrhelper">OpenXRHelper</a></li>
<li class="toctree-l4"><a class="reference internal" href="#graphicsapi">GraphicsAPI</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#openxrtutorial-and-main">1.4.3 OpenXRTutorial and Main</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-and-run">1.4.4 Build and Run</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="2-setup.html">‚öôÔ∏è 2 Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="3-graphics.html">üëæ 3 Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="4-actions.html">üïπ 4 Interactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="5-extensions.html">‚ú® 5 Extensions</a></li>
</ul>

        </div>
      </div>
    </nav>

	<div data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
			<i data-toggle="wy-nav-top" class="fa fa-bars"></i>
			<a href="index.html">OpenXR Tutorial</a>
		</nav>

		<div class="sticky-breadcrumb-ribbon" role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">üëã 1 Introduction</li>
	  <li class="disclaimer">Disclaimer: Work in Progress. This site is in progress and is not ready for use.</li>
	  <li class="wy-breadcrumbs-aside">
		  <div id='selectplatform'>
	<button class="select-platform" id='selectwindows' onclick="choosePlatform('windows')">
		<img class="platform-tab-img" src="_static/css/windows-colour.svg" alt="Windows" />
	</button>
	<button class="select-platform" id='selectlinux' onclick="choosePlatform('linux')">
		<img class="platform-tab-img" src="https://upload.wikimedia.org/wikipedia/commons/3/35/Tux.svg" alt="Linux" />
	</button>
	<button class="select-platform" id='selectandroid' onclick="choosePlatform('android')">
		<img class="platform-tab-img" src="_static/css/android-colour.svg" alt="Android" />
	</button>
</div>
<script>
	function choosePlatform(platformName)
	{
		var platform = Cookies.get('platform')
		Cookies.set('platform', platformName, { expires: 365 })
		updatePlatform();
	};
</script>

<div id='selectgraphicsapi'>
	<button class="select-graphics-api selectd3d11" id='selectd3d11' onclick="chooseGraphicsAPI('d3d11')">
		<img class="api-tab-img" src="_static/css/d3d11.png" alt="DirectX 11" />
	</button>
	<button class="select-graphics-api selectd3d12" id='selectd3d12' onclick="chooseGraphicsAPI('d3d12')">
		<img class="api-tab-img" src="_static/css/d3d12.png" alt="DirectX 12" />
	</button>
	<button class="select-graphics-api selectopengl" id='selectopengl' onclick="chooseGraphicsAPI('opengl')">
		<img class="api-tab-img" src="_static/css/opengl.png" alt="OpenGL" />
	</button>
	<button class="select-graphics-api selectopengles" id='selectopengles' onclick="chooseGraphicsAPI('opengles')">
		<img class="api-tab-img" src="_static/css/opengles.png" alt="OpenGL ES" />
	</button>
	<button class="select-graphics-api selectvulkan" id='selectvulkan' onclick="chooseGraphicsAPI('vulkan')">
		<img class="api-tab-img" src="_static/css/vulkan.png" alt="Vulkan" />
	</button>
</div>
<script>
	function chooseGraphicsAPI(graphicsApiName)
	{
		Cookies.set('graphicsapi', graphicsApiName, { expires: 365 })
		var graphicsApi = Cookies.get('graphicsapi')
		updateGraphicsAPI();
		limitAPIChoice();
	};
</script>
	  </li>
  </ul>
</div>
		<div class="wy-nav-content">
				<div class="rst-content">
					<div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
						<div itemprop="articleBody">
							
  <section id="introduction">
<h1>üëã 1 Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">¬∂</a></h1>
<section id="goal-of-openxr">
<h2>1.1 Goal of OpenXR<a class="headerlink" href="#goal-of-openxr" title="Permalink to this heading">¬∂</a></h2>
<p>OpenXR aims to help solve the fragmentation of the XR ecosystem. Before the advent of OpenXR, software developers working with multiple
hardware platforms had to write different code for each platform to address the different hardware.
Each platform had its own, often proprietary, API, and deploying an existing app to a new platform required a lot of
adaptation. Developing a new app for a new platform was even more challenging.</p>
<p>In spite of their unique features, the platforms had a great deal in common. For example, most headsets had a main view seen from two
slightly different perspectives. Most had a way to track the user‚Äôs head and hands or hand-controllers. Most had buttons,
many had analogue controls like triggers or joysticks; many had haptic feedback.</p>
<figure class="align-left" id="id11">
<a class="reference internal image-reference" href="_images/OpenXRBeforeAfter.png"><img alt="XR Fragmentation" src="_images/OpenXRBeforeAfter.png" style="width: 99%;" /></a>
<figcaption>
<p><span class="caption-text">OpenXR provides a common interface to reduce XR fragmentation.</span><a class="headerlink" href="#id11" title="Permalink to this image">¬∂</a></p>
</figcaption>
</figure>
<p>OpenXR aims to solve this problem by providing a common API to address XR hardware, in reading its inputs
and outputting to its displays and haptic systems. Just as OpenGL and Vulkan provide a common API to access graphics hardware, so OpenXR
allows you to write code that works with multiple XR platforms, with minimal adaptation.</p>
</section>
<section id="overview">
<h2>1.2 Overview<a class="headerlink" href="#overview" title="Permalink to this heading">¬∂</a></h2>
<p>We‚Äôll start with the main concepts you‚Äôll need to be familiar with around OpenXR.</p>
<table class="longtable docutils align-default" id="id12">
<caption><span class="caption-text">OpenXR Concepts</span><a class="headerlink" href="#id12" title="Permalink to this table">¬∂</a></caption>
<colgroup>
<col style="width: 16.7%" />
<col style="width: 83.3%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Concept</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>API</p></td>
<td><p>The OpenXR API is the set of commands, functions and structures that an OpenXR-compliant runtime is required to offer.</p></td>
</tr>
<tr class="row-odd"><td><p>Application</p></td>
<td><p>The Application is your program, called an ‚Äúapp‚Äù for short.</p></td>
</tr>
<tr class="row-even"><td><p>Runtime</p></td>
<td><dl class="simple">
<dt>A Runtime is a specific implementation of the OpenXR functionality. It might be provided by a</dt><dd><p>hardware vendor, as part of a device‚Äôs operating system; it might be supplied by a software vendor
to enable OpenXR support with a specific range of hardware. The Loader finds the appropriate Runtime
and loads it when OpenXR is initialized.</p>
</dd>
</dl>
</td>
</tr>
<tr class="row-odd"><td><p>Loader</p></td>
<td><dl class="simple">
<dt>The OpenXR loader is a special library that connects your app to whichever OpenXR runtime</dt><dd><p>you‚Äôre using. The loader‚Äôs job is to find the Runtime and initialize it, then allow your app to access
the Runtime‚Äôs version of the API. Some devices can have multiple Runtimes available, but only one can
be active at any given time.</p>
</dd>
</dl>
</td>
</tr>
<tr class="row-even"><td><p>Layers</p></td>
<td><dl class="simple">
<dt>API layers are optional components that augment an OpenXR system. A Layer might help with debugging,</dt><dd><p>or filter information between the app and the Runtime. API layers are enabled when the OpenXR Instance
is created.</p>
</dd>
</dl>
</td>
</tr>
<tr class="row-odd"><td><p>Instance</p></td>
<td><dl class="simple">
<dt>The Instance is an object that allows your app to communicate with a Runtime. You‚Äôll ask OpenXR to create an Instance</dt><dd><p>when initializing XR support in your app. If the Runtime supports it, you might have more than one Instance
at a time, if more than one XR device is in use.</p>
</dd>
</dl>
</td>
</tr>
<tr class="row-even"><td><p>Graphics</p></td>
<td><dl class="simple">
<dt>OpenXR usually needs to connect to a graphics API, in order to permit rendering of headset views for example.</dt><dd><p>Which Graphics API‚Äôs are supported depends on the Runtime.</p>
</dd>
</dl>
</td>
</tr>
<tr class="row-odd"><td><p>Input</p></td>
<td><dl class="simple">
<dt>The OpenXR Input System allows apps to query what inputs are available. These can then be bound</dt><dd><p>to Actions or Poses, so the app knows what the user is doing.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p>OpenXR‚Äôs lexicon and API style are based on the Vulkan API, and it provides a clear and precise common language for developers and hardware vendors to use. It was a decision by the OpenXR working group to have APIs similar.</p>
<p>An OpenXR Runtime implements the OpenXR API. There maybe multiple runtime installed on a system, but an OpenXR application can only choose one. The runtime acts to translate the OpenXR function calls into something that the vendor‚Äôs software/hardware can understand. There is a fully open source OpenXR runtime for Linux in development called <a class="reference external" href="https://monado.dev/">Monado</a>.</p>
<p>The OpenXR Loader finds and loads a suitable OpenXR runtime that is present on the system. The Loader will load in all of the OpenXR function pointers stated in the core specification for the application to use. If you are using an extension, such as <code class="docutils literal notranslate"><span class="pre">XR_EXT_debug_utils</span></code>, any functions associated with that extension will need to be loaded in with <code class="docutils literal notranslate"><span class="pre">xrGetInstanceProcAddr()</span></code>. Some platforms like Android require extra work and information to initialise the loader.</p>
<p>API Layers are additional code layers that are inserted between the application and the runtime. Each of these API layers intercepts the OpenXR function calls from the layer above, does something with that function, and then calls the next layer down. Some simple examples of API Layers would be logging the OpenXR functions to the output or a file, or creating trace file of the OpenXR calls for later replay. A validation layer could be used to check that the function calls made to OpenXR are compatible with the specification and with the current state of OpenXR, which would be very similar the Vulkan Validation layer.</p>
<p>OpenXR supports multiple graphics APIs via its extension functionality. Like in Vulkan, OpenXR can extend its functionality to include debugging layers, vendor hardware and software support and graphics APIs. This idea of absolving the core specification of the graphics API functionality, as bold as it might seem, provides us with the flexibility in choosing the graphics APIs now and in the future. Firstly, OpenXR is targeted at developing XR experiences and isn‚Äôt concerned with the specifics of any graphics APIs. Secondly, the extensive nature of OpenXR allows revisions of and any new graphics APIs to be integrated with ease. Already, there are two mutually exclusive extensions in OpenXR for interacting with Vulkan.</p>
<p>OpenXR recognised that there is vast and ever changing array of hardware and configurations in the XR space. With new headsets and controllers coming to the market, an abstraction of the input system was needed so that same application can target difference and newer hardware. The abstraction is done via the concept of an <code class="docutils literal notranslate"><span class="pre">XrAction</span></code>, which acts as handle to interactive elements of the application. Instead of directly querying the state of any one button, joysticks, trigger, touch pad etc., you create an <code class="docutils literal notranslate"><span class="pre">XrAction</span></code> for a specific action such as a ‚Äúmenu_click‚Äù. You provide a suggested binding along with an interaction profile so that OpenXR can link that action with the available input hardware at runtime.</p>
</section>
<section id="setting-up">
<h2>1.3 Setting Up<a class="headerlink" href="#setting-up" title="Permalink to this heading">¬∂</a></h2>
<p>This section will help you set up your development environment. Here your choice of platform really makes a difference. After that, things will be much more consistent.</p>
<p>You can change platform at any time by clicking the tabs at the top of the page. Select the platform you want to develop for
by clicking a tab, or one of the buttons below.</p>
<div class='select-platform-container-inline'>
	<button class="select-platform-inline" id='selectwindows-inline' onclick="choosePlatform('windows')">
		<img src="_static/css/windows-mono.svg" alt="Windows" />
		Windows
	</button>
	<button class="select-platform-inline" id='selectlinux-inline' onclick="choosePlatform('linux')">
		<img src="https://upload.wikimedia.org/wikipedia/commons/3/35/Tux.svg" alt="Linux" />
		Linux
	</button>
	<button class="select-platform-inline" id='selectandroid-inline' onclick="choosePlatform('android')">
		<img src="_static/css/android-original.svg" alt="Android" />
		Android
	</button>
</div>
<div class='select-graphics-api-container-inline'>
	<button class="select-graphics-api-inline selectd3d11" id='selectd3d11-inline' onclick="chooseGraphicsAPI('d3d11')">
		Direct3D 11
	</button>
	<button class="select-graphics-api-inline selectd3d12" id='selectd3d12-inline' onclick="chooseGraphicsAPI('d3d12')">
		Direct3D 12
	</button>
	<button class="select-graphics-api-inline selectopengl" id='selectopengl-inline' onclick="chooseGraphicsAPI('opengl')">
		OpenGL
	</button>
	<button class="select-graphics-api-inline selectopengles" id='selectopengles-inline' onclick="chooseGraphicsAPI('opengles')">
		OpenGL ES
	</button>
	<button class="select-graphics-api-inline selectvulkan" id='selectvulkan-inline' onclick="chooseGraphicsAPI('vulkan')">
		Vulkan
	</button>
</div>

<div class="windows docutils container" id="windows-id-1">
<p class="rubric">Visual Studio</p>
<p>If you‚Äôll be building an OpenXR project for Microsoft Windows PC based devices, we‚Äôll assume you‚Äôll be using Microsoft Visual Studio.
The free Community edition of Visual Studio is available to download <a class="reference external" href="https://visualstudio.microsoft.com/vs/community/">here</a>.</p>
<p class="rubric">CMake</p>
<p>Install the latest <a class="reference external" href="https://cmake.org/download/">CMake</a>. This tutorial uses CMake to generate the Visual Studio Solution and Project files.</p>
<p>Next you‚Äôll want to choose which Graphics API you‚Äôll be using.</p>
<div class="d3d11 d3d12 docutils container" id="d3d11-d3d12-id-1">
<p>Direct3D 11 and 12 are built into the Windows SDK‚Äôs. If you‚Äôre using Direct3D, D3D12 is recommended, because it supports <a class="reference external" href="https://microsoft.github.io/DirectX-Specs/d3d/ViewInstancing.html">View Instancing</a>. Essentially, it allows you to draw both eye views in one call.</p>
<p>In both cases, download and install the latest <a class="reference external" href="https://developer.microsoft.com/en-us/windows/downloads/windows-sdk/">Windows SDK</a>.</p>
</div>
<div class="vulkan docutils container" id="vulkan-id-1">
<p>If you‚Äôll be using Vulkan, download and install the latest <a class="reference external" href="https://www.lunarg.com/vulkan-sdk/">Vulkan SDK</a>. Vulkan also supports rendering to both eye views with multiview. <a class="reference external" href="https://registry.khronos.org/vulkan/specs/1.3-extensions/man/html/VK_KHR_multiview.html">Vulkan Multiview</a>.</p>
</div>
<div class="opengl docutils container" id="opengl-id-1">
<p>For this tutorial, we are using the ‚Äògfxwrapper‚Äô for the OpenGL API found as a part of the <a class="reference external" href="https://github.com/KhronosGroup/OpenXR-SDK-Source">OpenXR-SDK-Source</a> reposity under <code class="docutils literal notranslate"><span class="pre">src/common/</span></code>. It was originally developed by Oculus VR, LLC and The Brenwill Workshop Ltd.; this wrapper is written against the <a class="reference external" href="https://registry.khronos.org/OpenGL/specs/gl/glspec43.core.pdf">OpenGL 4.3</a> specification.
If you want to use OpenGL stand-alone, you will need to use WGL to create a valid OpenGL Context for Microsoft Windows - <a class="reference external" href="https://www.khronos.org/opengl/wiki/Creating_an_OpenGL_Context_(WGL)">Creating an OpenGL Context WGL</a>. You will also need to use a function loader like GLAD to access functions for OpenGL - <a class="reference external" href="https://glad.dav1d.de/">GLAD</a>. OpenGL also supports rendering to both eye views with multiview - <a class="reference external" href="https://registry.khronos.org/OpenGL/extensions/OVR/OVR_multiview.txt">OpenGL Multiview</a>.</p>
</div>
</div>
<div class="linux docutils container" id="linux-id-1">
<p class="rubric">Visual Studio Code for Linux</p>
<p>To install Visual Studio Code, go to <a class="reference external" href="https://code.visualstudio.com/">https://code.visualstudio.com/</a> and click the ‚ÄúDownload for Linux‚Äù button.</p>
<p>Install the latest <a class="reference external" href="https://cmake.org/download/">CMake</a>. This tutorial uses CMake with Visual Studio Code to build the project.</p>
<div class="vulkan docutils container" id="vulkan-id-2">
<p>If you‚Äôll be using Vulkan, download and install the latest <a class="reference external" href="https://www.lunarg.com/vulkan-sdk/">Vulkan SDK</a>. Vulkan also supports rendering to both eye views with multiview, which simplifies the rendering code. <a class="reference external" href="https://registry.khronos.org/vulkan/specs/1.3-extensions/man/html/VK_KHR_multiview.html">Vulkan Multiview</a>.</p>
</div>
<div class="opengl docutils container" id="opengl-id-2">
<p>For this tutorial, we are using the ‚Äògfxwrapper‚Äô for the OpenGL API found as a part of the <a class="reference external" href="https://github.com/KhronosGroup/OpenXR-SDK-Source">OpenXR-SDK-Source</a> reposity under <code class="docutils literal notranslate"><span class="pre">src/common/</span></code>. It was originally developed by Oculus VR, LLC and The Brenwill Workshop Ltd.; this wrapper is written against the <a class="reference external" href="https://registry.khronos.org/OpenGL/specs/gl/glspec43.core.pdf">OpenGL 4.3</a> specification.
If you want to use OpenGL stand-alone, you will need to use GLX to create a valid OpenGL Context for Linux - <a class="reference external" href="Tutorial:_OpenGL_3.0_Context_Creation_(GLX)">Tutorial: OpenGL 3.0 Context Creation (GLX)</a>. You will also need to use a function loader like GLAD to access functions for OpenGL - <a class="reference external" href="https://glad.dav1d.de/">GLAD</a>. OpenGL also supports rendering to both eye views with multiview, which simplifies the rendering code. <a class="reference external" href="https://registry.khronos.org/OpenGL/extensions/OVR/OVR_multiview.txt">OpenGL Multiview</a>.</p>
</div>
</div>
<div class="android docutils container" id="android-id-1">
<p>Android Studio is available to download here: <a class="reference external" href="https://developer.android.com/studio">https://developer.android.com/studio</a>.</p>
<p class="rubric">OpenXR SDK</p>
<p>In conjunction with the later <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code>, we add the OpenXR SDK to our dependencies in the <code class="docutils literal notranslate"><span class="pre">app/build.gradle</span></code> file. The <code class="docutils literal notranslate"><span class="pre">openxr_loader_for_android</span></code> provides an <code class="docutils literal notranslate"><span class="pre">AndroidManifest.xml</span></code> that will be merged into our own, setting some required properties for the package and application. With this though, we are still required to add to our own <code class="docutils literal notranslate"><span class="pre">AndroidManifest.xml</span></code> file the relevant intent filters, such as <code class="docutils literal notranslate"><span class="pre">&lt;category</span> <span class="pre">android:name=&quot;org.khronos.openxr.intent.category.IMMERSIVE_HMD&quot;</span> <span class="pre">/&gt;</span></code>. It also provides the OpenXR headers and library binaries in a format that the Android Gradle Plugin will expose to CMake.</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">dependencies</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">implementation</span><span class="w"> </span><span class="s1">&#39;org.khronos.openxr:openxr_loader_for_android:1.0.28.2&#39;</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="vulkan docutils container" id="vulkan-id-3">
<p>Vulkan is recommended for Android for its modern, low-level API and extension.
Vulkan is included as part of the NDK provided Google and is supported on Android 7.0 (Nougat), API level 24 or higher. <a class="reference external" href="https://developer.android.com/ndk/guides/graphics">https://developer.android.com/ndk/guides/graphics</a>. Vulkan also supports rendering to both eye views with multiview, which simplifies the rendering code. <a class="reference external" href="https://registry.khronos.org/vulkan/specs/1.3-extensions/man/html/VK_KHR_multiview.html">Vulkan Multiview</a>.</p>
</div>
<div class="opengles docutils container" id="opengles-id-1">
<p>Alternatively, OpenGL ES is also an option for Android graphics.
For this tutorial, we are using the ‚Äògfxwrapper‚Äô for the OpenGL ES API found as a part of the <a class="reference external" href="https://github.com/KhronosGroup/OpenXR-SDK-Source">OpenXR-SDK-Source</a> reposity under <code class="docutils literal notranslate"><span class="pre">src/common/</span></code>.
If you want to use OpenGL ES stand-alone, you will need to use EGL to create a valid OpenGL ES Context for Android - <a class="reference external" href="https://www.khronos.org/egl">EGL Overview</a>. You will also need to use a function loader like GLAD to access functions for OpenGL ES - <a class="reference external" href="https://glad.dav1d.de/">GLAD</a>. OpenGL ES also supports rendering to both eye views with multiview, which simplifies the rendering code. <a class="reference external" href="https://registry.khronos.org/OpenGL/extensions/OVR/OVR_multiview.txt">OpenGL ES Multiview</a>.</p>
</div>
</div>
<p class="rubric">OpenXR SDK</p>
<p>In this tutorial, we will use CMake <code class="docutils literal notranslate"><span class="pre">FetchContent_Declare()</span></code> command in the <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> files to get the OpenXR SDK package from Khronos‚Äôs OpenXR-SDK-Source GitHub page, as shown below.</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="c"># For FetchContent_Declare() and FetchContent_MakeAvailable()</span>
<span class="nb">include</span><span class="p">(</span><span class="s">FetchContent</span><span class="p">)</span>

<span class="c"># openxr_loader - From github.com/KhronosGroup</span>
<span class="nb">set</span><span class="p">(</span><span class="s">BUILD_ALL_EXTENSIONS</span><span class="w"> </span><span class="s">ON</span><span class="w"> </span><span class="s">CACHE</span><span class="w"> </span><span class="s">INTERNAL</span><span class="w"> </span><span class="s2">&quot;Build loader and layers with all extensions&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">BUILD_TESTS</span><span class="w"> </span><span class="s">OFF</span><span class="w"> </span><span class="s">CACHE</span><span class="w"> </span><span class="s">INTERNAL</span><span class="w"> </span><span class="s2">&quot;Build tests&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">BUILD_CONFORMANCE_TESTS</span><span class="w"> </span><span class="s">OFF</span><span class="w"> </span><span class="s">CACHE</span><span class="w"> </span><span class="s">INTERNAL</span><span class="w"> </span><span class="s2">&quot;Build conformance tests&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">BUILD_API_LAYERS</span><span class="w"> </span><span class="s">ON</span><span class="w"> </span><span class="s">CACHE</span><span class="w"> </span><span class="s">INTERNAL</span><span class="w"> </span><span class="s2">&quot;Use OpenXR layers&quot;</span><span class="p">)</span>
<span class="nb">FetchContent_Declare</span><span class="p">(</span>
<span class="w">        </span><span class="s">OpenXR</span>
<span class="w">        </span><span class="c"># URL_HASH MD5=390455e9395a92d6b730afb8f23fac8e</span>
<span class="w">        </span><span class="c"># URL https://github.com/KhronosGroup/OpenXR-SDK-Source/archive/refs/tags/release-1.0.27.zip</span>
<span class="w">        </span><span class="s">URL_HASH</span><span class="w"> </span><span class="s">MD5=81930f0ccecdca852906e1a22aee4a45</span>
<span class="w">        </span><span class="s">URL</span><span class="w"> </span><span class="s">https://github.com/KhronosGroup/OpenXR-SDK-Source/archive/refs/tags/release-1.0.28.zip</span>
<span class="w">        </span><span class="s">DOWNLOAD_EXTRACT_TIMESTAMP</span><span class="w"> </span><span class="s">TRUE</span>
<span class="w">        </span><span class="s">SOURCE_DIR</span><span class="w"> </span><span class="s">openxr</span><span class="p">)</span>
<span class="nb">FetchContent_MakeAvailable</span><span class="p">(</span><span class="s">OpenXR</span><span class="p">)</span>
</pre></div>
</div>
<p>Download <a class="reference download internal" download="" href="_downloads/cd76e933f0032a33ba56954bc3ae053e/CMakeLists.txt"><code class="xref download docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code></a></p>
<p>If you prefer to git clone or download the SDK yourself from <a class="reference external" href="https://github.com/KhronosGroup/OpenXR-SDK">Khronos‚Äôs OpenXR-SDK-Source GitHub page</a>. You can either use your preferred command-line or GUI Git tool, or download it as a .zip file.</p>
<p>With the OpenXR loader and your graphics API selected, you‚Äôre ready to start creating your first OpenXR project.</p>
</section>
<section id="project-setup">
<h2>1.4 Project Setup<a class="headerlink" href="#project-setup" title="Permalink to this heading">¬∂</a></h2>
<p>This sub-chapter explains how to setup your project ready for <a class="reference internal" href="2-setup.html#creating-an-xrinstance-xrgetsystem"><span class="std std-ref">Chapter 2</span></a> and will make references to the <code class="docutils literal notranslate"><span class="pre">/Chapter2</span></code> folder. It explains including the OpenXR headers, linking the <code class="docutils literal notranslate"><span class="pre">openxr_loader</span></code> library, graphics API integration, other boilerplate code and finally creating a simple stub-application with the <code class="docutils literal notranslate"><span class="pre">OpenXRTutorial</span></code> class to test.</p>
<section id="cmake-and-project-files">
<h3>1.4.1 CMake and Project Files<a class="headerlink" href="#cmake-and-project-files" title="Permalink to this heading">¬∂</a></h3>
<div class="windows docutils container" id="windows-id-2">
<p>For the Microsoft Windows OpenXR project, we‚Äôll use CMake to create the solution and project files for Visual Studio.
First, create a directory where the code will go, we‚Äôll call this the <em>workspace</em> directory.</p>
</div>
<div class="linux docutils container" id="linux-id-2">
<p>You are free to use any code editor and/or compiler; this tutorial will use Visual Studio Code.
For the Linux OpenXR project, we‚Äôll use CMake alongside Visual Studio Code to build the project.
First, create a directory where the code will go, we‚Äôll call this the <em>workspace</em> directory. Open Visual Studio Code and from the File menu, select ‚ÄúOpen Folder‚Ä¶‚Äù</p>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/linux-vscode-open-folder.png"><img alt="The File menu of Visual Studio Code is shown, with the command &quot;Open Folder...&quot; selected." src="_images/linux-vscode-open-folder.png" style="width: 391.05px; height: 234.3px;" /></a>
</figure>
<p>Select your <em>workspace</em> folder, which is currently empty.</p>
<p>If you haven‚Äôt previously done so, install the CMake extension for Visual Studio Code.</p>
</div>
<div class="windows linux docutils container" id="windows-linux-id-1">
<p>Now, create a text file in the <em>workspace</em> folder called <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> and in it, put the following code:</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="s">VERSION</span><span class="w"> </span><span class="s">3.15</span><span class="p">)</span>

<span class="nb">project</span><span class="p">(</span><span class="s">openxr-tutorial</span><span class="p">)</span>

<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CONFIGURATION_TYPES</span><span class="w"> </span><span class="s2">&quot;Debug;Release&quot;</span><span class="p">)</span>

<span class="c"># Optional selected runtime</span>
<span class="nb">set</span><span class="p">(</span><span class="s">XR_RUNTIME_JSON</span><span class="w"> </span><span class="s2">&quot;$ENV{XR_RUNTIME_JSON}&quot;</span><span class="w"> </span><span class="s">CACHE</span><span class="w"> </span><span class="s">PATH</span><span class="w"> </span><span class="s2">&quot;Optional location of a specific OpenXR runtime configuration file.&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">add_subdirectory</span><span class="p">(</span><span class="s">Chapter2</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, we specify the CMake version, project name and the configurations types, which we limit to just Debug and Release.
You can use <code class="docutils literal notranslate"><span class="pre">XR_RUNTIME_JSON</span></code> to specify an optional runtime. The one provided by your hardware vendor will be automatically used, though this feature is helpful for debugging on different runtimes.
Finally, we specify CMake to continue the build into the Chapter2 directory with <code class="docutils literal notranslate"><span class="pre">add_subdirectory()</span></code>.</p>
<p>In the workspace folder, create a folder called <code class="docutils literal notranslate"><span class="pre">Chapter2</span></code>, and in it create another <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> file.
In it, put the following code:</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="s">VERSION</span><span class="w"> </span><span class="s">3.22.1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="c"># For FetchContent_Declare() and FetchContent_MakeAvailable()</span>
<span class="nb">include</span><span class="p">(</span><span class="s">FetchContent</span><span class="p">)</span>

<span class="c"># openxr_loader - From github.com/KhronosGroup</span>
<span class="nb">set</span><span class="p">(</span><span class="s">BUILD_ALL_EXTENSIONS</span><span class="w"> </span><span class="s">ON</span><span class="w"> </span><span class="s">CACHE</span><span class="w"> </span><span class="s">INTERNAL</span><span class="w"> </span><span class="s2">&quot;Build loader and layers with all extensions&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">BUILD_TESTS</span><span class="w"> </span><span class="s">OFF</span><span class="w"> </span><span class="s">CACHE</span><span class="w"> </span><span class="s">INTERNAL</span><span class="w"> </span><span class="s2">&quot;Build tests&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">BUILD_CONFORMANCE_TESTS</span><span class="w"> </span><span class="s">OFF</span><span class="w"> </span><span class="s">CACHE</span><span class="w"> </span><span class="s">INTERNAL</span><span class="w"> </span><span class="s2">&quot;Build conformance tests&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">BUILD_API_LAYERS</span><span class="w"> </span><span class="s">ON</span><span class="w"> </span><span class="s">CACHE</span><span class="w"> </span><span class="s">INTERNAL</span><span class="w"> </span><span class="s2">&quot;Use OpenXR layers&quot;</span><span class="p">)</span>
<span class="nb">FetchContent_Declare</span><span class="p">(</span>
<span class="w">        </span><span class="s">OpenXR</span>
<span class="w">        </span><span class="c"># URL_HASH MD5=390455e9395a92d6b730afb8f23fac8e</span>
<span class="w">        </span><span class="c"># URL https://github.com/KhronosGroup/OpenXR-SDK-Source/archive/refs/tags/release-1.0.27.zip</span>
<span class="w">        </span><span class="s">URL_HASH</span><span class="w"> </span><span class="s">MD5=81930f0ccecdca852906e1a22aee4a45</span>
<span class="w">        </span><span class="s">URL</span><span class="w"> </span><span class="s">https://github.com/KhronosGroup/OpenXR-SDK-Source/archive/refs/tags/release-1.0.28.zip</span>
<span class="w">        </span><span class="s">DOWNLOAD_EXTRACT_TIMESTAMP</span><span class="w"> </span><span class="s">TRUE</span>
<span class="w">        </span><span class="s">SOURCE_DIR</span><span class="w"> </span><span class="s">openxr</span><span class="p">)</span>
<span class="nb">FetchContent_MakeAvailable</span><span class="p">(</span><span class="s">OpenXR</span><span class="p">)</span>
</pre></div>
</div>
<p>After setting our CMake version, we include <code class="docutils literal notranslate"><span class="pre">FetchContent</span></code> and use it to get the OpenXR-SDK from Khronos‚Äôs GitHub page. Now, we will add to our <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> to specify the source and header files by adding the following code. Here, we are including all the files needed for our project.</p>
<div class="d3d11 docutils container" id="d3d11-id-1">
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="c"># Files</span>
<span class="nb">set</span><span class="p">(</span><span class="s">SOURCES</span><span class="w"> </span>
<span class="w">    </span><span class="s2">&quot;main.cpp&quot;</span>
<span class="hll"><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI.cpp&quot;</span>
</span><span class="hll"><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_D3D11.cpp&quot;</span>
</span><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_D3D12.cpp&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_OpenGL.cpp&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_OpenGL_ES.cpp&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_Vulkan.cpp&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/OpenXRDebugUtils.cpp&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">HEADERS</span><span class="w"> </span>
<span class="w">    </span><span class="s2">&quot;../Common/DebugOutput.h&quot;</span>
<span class="hll"><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI.h&quot;</span>
</span><span class="hll"><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_D3D11.h&quot;</span>
</span><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_D3D12.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_OpenGL.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_OpenGL_ES.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_Vulkan.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/HelperFunctions.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/OpenXRDebugUtils.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/OpenXRHelper.h&quot;</span><span class="w"> </span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="d3d12 docutils container" id="d3d12-id-1">
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="c"># Files</span>
<span class="nb">set</span><span class="p">(</span><span class="s">SOURCES</span><span class="w"> </span>
<span class="w">    </span><span class="s2">&quot;main.cpp&quot;</span>
<span class="hll"><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI.cpp&quot;</span>
</span><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_D3D11.cpp&quot;</span>
<span class="hll"><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_D3D12.cpp&quot;</span>
</span><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_OpenGL.cpp&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_OpenGL_ES.cpp&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_Vulkan.cpp&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/OpenXRDebugUtils.cpp&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">HEADERS</span><span class="w"> </span>
<span class="w">    </span><span class="s2">&quot;../Common/DebugOutput.h&quot;</span>
<span class="hll"><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI.h&quot;</span>
</span><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_D3D11.h&quot;</span>
<span class="hll"><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_D3D12.h&quot;</span>
</span><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_OpenGL.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_OpenGL_ES.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_Vulkan.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/HelperFunctions.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/OpenXRDebugUtils.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/OpenXRHelper.h&quot;</span><span class="w"> </span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="opengl docutils container" id="opengl-id-3">
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="c"># Files</span>
<span class="nb">set</span><span class="p">(</span><span class="s">SOURCES</span><span class="w"> </span>
<span class="w">    </span><span class="s2">&quot;main.cpp&quot;</span>
<span class="hll"><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI.cpp&quot;</span>
</span><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_D3D11.cpp&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_D3D12.cpp&quot;</span>
<span class="hll"><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_OpenGL.cpp&quot;</span>
</span><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_OpenGL_ES.cpp&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_Vulkan.cpp&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/OpenXRDebugUtils.cpp&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">HEADERS</span><span class="w"> </span>
<span class="w">    </span><span class="s2">&quot;../Common/DebugOutput.h&quot;</span>
<span class="hll"><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI.h&quot;</span>
</span><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_D3D11.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_D3D12.h&quot;</span>
<span class="hll"><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_OpenGL.h&quot;</span>
</span><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_OpenGL_ES.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_Vulkan.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/HelperFunctions.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/OpenXRDebugUtils.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/OpenXRHelper.h&quot;</span><span class="w"> </span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="vulkan docutils container" id="vulkan-id-4">
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="c"># Files</span>
<span class="nb">set</span><span class="p">(</span><span class="s">SOURCES</span><span class="w"> </span>
<span class="w">    </span><span class="s2">&quot;main.cpp&quot;</span>
<span class="hll"><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI.cpp&quot;</span>
</span><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_D3D11.cpp&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_D3D12.cpp&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_OpenGL.cpp&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_OpenGL_ES.cpp&quot;</span>
<span class="hll"><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_Vulkan.cpp&quot;</span>
</span><span class="w">    </span><span class="s2">&quot;../Common/OpenXRDebugUtils.cpp&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">HEADERS</span><span class="w"> </span>
<span class="w">    </span><span class="s2">&quot;../Common/DebugOutput.h&quot;</span>
<span class="hll"><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI.h&quot;</span>
</span><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_D3D11.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_D3D12.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_OpenGL.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_OpenGL_ES.h&quot;</span>
<span class="hll"><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_Vulkan.h&quot;</span>
</span><span class="w">    </span><span class="s2">&quot;../Common/HelperFunctions.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/OpenXRDebugUtils.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/OpenXRHelper.h&quot;</span><span class="w"> </span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>All the files listed above with <code class="docutils literal notranslate"><span class="pre">../Common/*.*</span></code> are available to download from this tutorial website. In the next section, you will find the links and discussion of their usage within this tutorial and with OpenXR. This tutorial includes all the graphics APIs header and cpp files; you only need to download the files pertaining to your graphics API choice.</p>
<p>You should remove the <code class="docutils literal notranslate"><span class="pre">GraphicsAPI</span></code> cpp and header files that do not relate to your chosen graphics API from the <code class="docutils literal notranslate"><span class="pre">Chapter2/CMakeList.txt</span></code> files. You must keep <code class="docutils literal notranslate"><span class="pre">GraphicsAPI.cpp</span></code> and <code class="docutils literal notranslate"><span class="pre">OpenXRDebugUtils.cpp</span></code> in the <code class="docutils literal notranslate"><span class="pre">SOURCES</span></code> list and also keep <code class="docutils literal notranslate"><span class="pre">DebugOutput.h</span></code>, <code class="docutils literal notranslate"><span class="pre">GraphicsAPI.h</span></code>, <code class="docutils literal notranslate"><span class="pre">HelperFunctions.h</span></code>, <code class="docutils literal notranslate"><span class="pre">OpenXRDebugUtils.h</span></code> and <code class="docutils literal notranslate"><span class="pre">OpenXRHelper.h</span></code> in the <code class="docutils literal notranslate"><span class="pre">HEADERS</span></code> list.</p>
<p>At this point, we‚Äôll also create our text file called <code class="docutils literal notranslate"><span class="pre">main.cpp</span></code> in the <code class="docutils literal notranslate"><span class="pre">/Chapter2</span></code> directory. This will be our main source file, which we will use later in this chapter.</p>
<p>Now, we will continue with the <code class="docutils literal notranslate"><span class="pre">Chapter2/CMakeList.txt</span></code>, adding the following code.</p>
<div class="d3d11 docutils container" id="d3d11-id-2">
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">add_executable</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="o">${</span><span class="nv">SOURCES</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nv">HEADERS</span><span class="o">}</span><span class="p">)</span>

<span class="nb">if</span><span class="p">(</span><span class="s">NOT</span><span class="w"> </span><span class="s2">&quot;${XR_RUNTIME_JSON}&quot;</span><span class="w"> </span><span class="s">STREQUAL</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nb">set_target_properties</span><span class="p">(</span><span class="w"> </span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PROPERTIES</span><span class="w"> </span><span class="s">VS_DEBUGGER_ENVIRONMENT</span><span class="w"> </span><span class="s2">&quot;XR_RUNTIME_JSON=${XR_RUNTIME_JSON}&quot;</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>
<span class="nb">target_include_directories</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="s2">&quot;../Common/&quot;</span><span class="p">)</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">openxr_loader</span><span class="p">)</span>

<span class="nb">if</span><span class="w"> </span><span class="p">(</span><span class="s">WIN32</span><span class="p">)</span>
<span class="hll"><span class="w">    </span><span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s2">&quot;d3d11.lib&quot;</span><span class="p">)</span><span class="w"> </span>
</span><span class="w">    </span><span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s2">&quot;d3d12.lib&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="hll"><span class="w">    </span><span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s2">&quot;dxgi.lib&quot;</span><span class="p">)</span><span class="w"> </span>
</span><span class="nb">else</span><span class="p">()</span>
<span class="w">    </span><span class="nb">target_compile_definitions</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="s">OS_LINUX_WAYLAND=1</span><span class="w"> </span><span class="s">XR_USE_PLATFORM_WAYLAND=1</span><span class="w"> </span><span class="s">XR_USE_GRAPHICS_API_OPENGL=1</span><span class="w"> </span><span class="s">LINUX=1</span><span class="p">)</span><span class="c">#XR_USE_GRAPHICS_API_VULKAN=1 </span>
<span class="nb">endif</span><span class="p">()</span>

<span class="nb">find_package</span><span class="p">(</span><span class="s">Vulkan</span><span class="p">)</span>
<span class="nb">if</span><span class="w"> </span><span class="p">(</span><span class="s">Vulkan_FOUND</span><span class="p">)</span>
<span class="w">    </span><span class="nb">target_include_directories</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="o">${</span><span class="nv">Vulkan_INCLUDE_DIRS</span><span class="o">}</span><span class="p">)</span>
<span class="w">    </span><span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="o">${</span><span class="nv">Vulkan_LIBRARIES</span><span class="o">}</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>

<span class="c"># Fix redirection to a different project&#39;s build folder</span>
<span class="nb">target_include_directories</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_BINARY_DIR</span><span class="o">}</span><span class="s">/../Chapter2/openxr/src/common</span><span class="p">)</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">openxr-gfxwrapper</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="d3d12 docutils container" id="d3d12-id-2">
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">add_executable</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="o">${</span><span class="nv">SOURCES</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nv">HEADERS</span><span class="o">}</span><span class="p">)</span>

<span class="nb">if</span><span class="p">(</span><span class="s">NOT</span><span class="w"> </span><span class="s2">&quot;${XR_RUNTIME_JSON}&quot;</span><span class="w"> </span><span class="s">STREQUAL</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nb">set_target_properties</span><span class="p">(</span><span class="w"> </span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PROPERTIES</span><span class="w"> </span><span class="s">VS_DEBUGGER_ENVIRONMENT</span><span class="w"> </span><span class="s2">&quot;XR_RUNTIME_JSON=${XR_RUNTIME_JSON}&quot;</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>
<span class="nb">target_include_directories</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="s2">&quot;../Common/&quot;</span><span class="p">)</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">openxr_loader</span><span class="p">)</span>

<span class="nb">if</span><span class="w"> </span><span class="p">(</span><span class="s">WIN32</span><span class="p">)</span>
<span class="w">    </span><span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s2">&quot;d3d11.lib&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="hll"><span class="w">    </span><span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s2">&quot;d3d12.lib&quot;</span><span class="p">)</span><span class="w"> </span>
</span><span class="hll"><span class="w">    </span><span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s2">&quot;dxgi.lib&quot;</span><span class="p">)</span><span class="w"> </span>
</span><span class="nb">else</span><span class="p">()</span>
<span class="w">    </span><span class="nb">target_compile_definitions</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="s">OS_LINUX_WAYLAND=1</span><span class="w"> </span><span class="s">XR_USE_PLATFORM_WAYLAND=1</span><span class="w"> </span><span class="s">XR_USE_GRAPHICS_API_OPENGL=1</span><span class="w"> </span><span class="s">LINUX=1</span><span class="p">)</span><span class="c">#XR_USE_GRAPHICS_API_VULKAN=1 </span>
<span class="nb">endif</span><span class="p">()</span>

<span class="nb">find_package</span><span class="p">(</span><span class="s">Vulkan</span><span class="p">)</span>
<span class="nb">if</span><span class="w"> </span><span class="p">(</span><span class="s">Vulkan_FOUND</span><span class="p">)</span>
<span class="w">    </span><span class="nb">target_include_directories</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="o">${</span><span class="nv">Vulkan_INCLUDE_DIRS</span><span class="o">}</span><span class="p">)</span>
<span class="w">    </span><span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="o">${</span><span class="nv">Vulkan_LIBRARIES</span><span class="o">}</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>

<span class="c"># Fix redirection to a different project&#39;s build folder</span>
<span class="nb">target_include_directories</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_BINARY_DIR</span><span class="o">}</span><span class="s">/../Chapter2/openxr/src/common</span><span class="p">)</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">openxr-gfxwrapper</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="opengl docutils container" id="opengl-id-4">
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">add_executable</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="o">${</span><span class="nv">SOURCES</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nv">HEADERS</span><span class="o">}</span><span class="p">)</span>

<span class="nb">if</span><span class="p">(</span><span class="s">NOT</span><span class="w"> </span><span class="s2">&quot;${XR_RUNTIME_JSON}&quot;</span><span class="w"> </span><span class="s">STREQUAL</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nb">set_target_properties</span><span class="p">(</span><span class="w"> </span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PROPERTIES</span><span class="w"> </span><span class="s">VS_DEBUGGER_ENVIRONMENT</span><span class="w"> </span><span class="s2">&quot;XR_RUNTIME_JSON=${XR_RUNTIME_JSON}&quot;</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>
<span class="nb">target_include_directories</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="s2">&quot;../Common/&quot;</span><span class="p">)</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">openxr_loader</span><span class="p">)</span>

<span class="nb">if</span><span class="w"> </span><span class="p">(</span><span class="s">WIN32</span><span class="p">)</span>
<span class="w">    </span><span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s2">&quot;d3d11.lib&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="w">    </span><span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s2">&quot;d3d12.lib&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="w">    </span><span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s2">&quot;dxgi.lib&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="nb">else</span><span class="p">()</span>
<span class="w">    </span><span class="nb">target_compile_definitions</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="s">OS_LINUX_WAYLAND=1</span><span class="w"> </span><span class="s">XR_USE_PLATFORM_WAYLAND=1</span><span class="w"> </span><span class="s">XR_USE_GRAPHICS_API_OPENGL=1</span><span class="w"> </span><span class="s">LINUX=1</span><span class="p">)</span><span class="c">#XR_USE_GRAPHICS_API_VULKAN=1 </span>
<span class="nb">endif</span><span class="p">()</span>

<span class="nb">find_package</span><span class="p">(</span><span class="s">Vulkan</span><span class="p">)</span>
<span class="nb">if</span><span class="w"> </span><span class="p">(</span><span class="s">Vulkan_FOUND</span><span class="p">)</span>
<span class="w">    </span><span class="nb">target_include_directories</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="o">${</span><span class="nv">Vulkan_INCLUDE_DIRS</span><span class="o">}</span><span class="p">)</span>
<span class="w">    </span><span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="o">${</span><span class="nv">Vulkan_LIBRARIES</span><span class="o">}</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>

<span class="hll"><span class="c"># Fix redirection to a different project&#39;s build folder</span>
</span><span class="hll"><span class="nb">target_include_directories</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_BINARY_DIR</span><span class="o">}</span><span class="s">/../Chapter2/openxr/src/common</span><span class="p">)</span>
</span><span class="hll"><span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">openxr-gfxwrapper</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
<div class="vulkan docutils container" id="vulkan-id-5">
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">add_executable</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="o">${</span><span class="nv">SOURCES</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nv">HEADERS</span><span class="o">}</span><span class="p">)</span>

<span class="nb">if</span><span class="p">(</span><span class="s">NOT</span><span class="w"> </span><span class="s2">&quot;${XR_RUNTIME_JSON}&quot;</span><span class="w"> </span><span class="s">STREQUAL</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nb">set_target_properties</span><span class="p">(</span><span class="w"> </span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PROPERTIES</span><span class="w"> </span><span class="s">VS_DEBUGGER_ENVIRONMENT</span><span class="w"> </span><span class="s2">&quot;XR_RUNTIME_JSON=${XR_RUNTIME_JSON}&quot;</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>
<span class="nb">target_include_directories</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="s2">&quot;../Common/&quot;</span><span class="p">)</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">openxr_loader</span><span class="p">)</span>

<span class="nb">if</span><span class="w"> </span><span class="p">(</span><span class="s">WIN32</span><span class="p">)</span>
<span class="w">    </span><span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s2">&quot;d3d11.lib&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="w">    </span><span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s2">&quot;d3d12.lib&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="w">    </span><span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s2">&quot;dxgi.lib&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="nb">else</span><span class="p">()</span>
<span class="w">    </span><span class="nb">target_compile_definitions</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="s">OS_LINUX_WAYLAND=1</span><span class="w"> </span><span class="s">XR_USE_PLATFORM_WAYLAND=1</span><span class="w"> </span><span class="s">XR_USE_GRAPHICS_API_OPENGL=1</span><span class="w"> </span><span class="s">LINUX=1</span><span class="p">)</span><span class="c">#XR_USE_GRAPHICS_API_VULKAN=1 </span>
<span class="nb">endif</span><span class="p">()</span>

<span class="hll"><span class="nb">find_package</span><span class="p">(</span><span class="s">Vulkan</span><span class="p">)</span>
</span><span class="hll"><span class="nb">if</span><span class="w"> </span><span class="p">(</span><span class="s">Vulkan_FOUND</span><span class="p">)</span>
</span><span class="hll"><span class="w">    </span><span class="nb">target_include_directories</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="o">${</span><span class="nv">Vulkan_INCLUDE_DIRS</span><span class="o">}</span><span class="p">)</span>
</span><span class="hll"><span class="w">    </span><span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="o">${</span><span class="nv">Vulkan_LIBRARIES</span><span class="o">}</span><span class="p">)</span>
</span><span class="hll"><span class="nb">endif</span><span class="p">()</span>
</span>
<span class="c"># Fix redirection to a different project&#39;s build folder</span>
<span class="nb">target_include_directories</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_BINARY_DIR</span><span class="o">}</span><span class="s">/../Chapter2/openxr/src/common</span><span class="p">)</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">openxr-gfxwrapper</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now, we have set up the project by adding an executable by using <code class="docutils literal notranslate"><span class="pre">add_executable()</span></code> specifying the <code class="docutils literal notranslate"><span class="pre">${SOURCES}</span></code> and <code class="docutils literal notranslate"><span class="pre">${HEADERS}</span></code>. We have optionally set a the <code class="docutils literal notranslate"><span class="pre">XR_RUNTIME_JSON</span></code> in the debugger environment. We‚Äôve added the <code class="docutils literal notranslate"><span class="pre">../Common</span></code> folder as an include directory and linked <code class="docutils literal notranslate"><span class="pre">openxr_loader</span></code> from <code class="docutils literal notranslate"><span class="pre">FetchContent</span></code>. We didn‚Äôt have to add OpenXR as a include directory; as we have specified it to be located in the CMake Build directory under <code class="docutils literal notranslate"><span class="pre">openxr/</span></code> when using <code class="docutils literal notranslate"><span class="pre">FetchContent</span></code>, so we‚Äôve only included the OpenXR headers from the CMake Build directory.</p>
<p>We have also added the include directories and linkage for the graphics APIs.
For Microsoft Windows, we‚Äôve linked <code class="docutils literal notranslate"><span class="pre">d3d11.lib</span></code>, <code class="docutils literal notranslate"><span class="pre">d3d12.lib</span></code> and <code class="docutils literal notranslate"><span class="pre">dxgi.lib</span></code>, so that we can use Direct3D 11, Direct3D 12 and the DirectX Graphics Infrastructure. The headers for Direct3D are automatically included as part of the Visual Studio project.
If you have the Vulkan SDK installed, this CMake code will try to find that package, add the include directories and link the Vulkan libraries.
As a default, this CMake has added gfxwrapper for OpenGL, we‚Äôve added the include directories and linked the gfxwrapper libraries from the OpenXR-SDK.</p>
<p>Note: You can remove or comment out from the above CMake code any references to graphics APIs that are not in use, if you wish to do so. Leaving them in place will not effect your project.</p>
<p>That‚Äôs all the CMake code that we require for this project.</p>
</div>
<div class="android docutils container" id="android-id-2">
<p>Here, We‚Äôll show how to hand build an Android Studio project that runs a C++ Native Activity.
First, we will create a <em>workspace</em> folder and in that folder create that <code class="docutils literal notranslate"><span class="pre">/Chapter2</span></code> folder,
Open Android Studio, select New Project and choose an Empty Activity. Set the Name to ‚ÄòOpenXR Tutorial Chapter 2‚Äô, the Package name to ‚Äòcom.simul.OpenXRTutorialChapter2‚Äô and save location to that <code class="docutils literal notranslate"><span class="pre">/Chapter2</span></code> folder. The language can be ignored here as we are using C++, and we can set the Minimum SDK to API 24: Android 7.0(Nougat). Complete the set up.</p>
<figure class="align-left">
<img alt="Android Studio - New Project - Empty Activity." src="_images/android-studio-newproject.png" />
</figure>
<p class="rubric">CMake</p>
<p>With the Android Studio project now set up, we need to modify some of the files and folders so as to set up the project to support the C++ Native Activity.
Under the <code class="docutils literal notranslate"><span class="pre">app</span></code> folder, you can delete the <code class="docutils literal notranslate"><span class="pre">libs</span></code> folder, and under the <code class="docutils literal notranslate"><span class="pre">app/src</span></code> you can also delete the <code class="docutils literal notranslate"><span class="pre">androidTest</span></code> and <code class="docutils literal notranslate"><span class="pre">test</span></code> folders. Finally under <code class="docutils literal notranslate"><span class="pre">app/src/main</span></code>, delete the <code class="docutils literal notranslate"><span class="pre">java</span></code> folder and add a <code class="docutils literal notranslate"><span class="pre">cpp</span></code> folder. Under the <code class="docutils literal notranslate"><span class="pre">app/src/main/res</span></code>, delete the <code class="docutils literal notranslate"><span class="pre">layout</span></code>, <code class="docutils literal notranslate"><span class="pre">values-night</span></code> and <code class="docutils literal notranslate"><span class="pre">xml</span></code> folders. Under the <code class="docutils literal notranslate"><span class="pre">values</span></code> folder, delete <code class="docutils literal notranslate"><span class="pre">colors.xml</span></code> and <code class="docutils literal notranslate"><span class="pre">themes.xml</span></code></p>
<p>Create a <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> in the <code class="docutils literal notranslate"><span class="pre">/Chapter2</span></code> directory for compatibility with other platforms. We will use this file to specific how our Native C++ code will be built. This <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> file will be invoked by Android Studio‚Äôs Gradle build system and we will point Gradle to this CMake file.</p>
<p class="rubric">CMakeLists.txt</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="s">VERSION</span><span class="w"> </span><span class="s">3.22.1</span><span class="p">)</span>
<span class="nb">project</span><span class="p">(</span><span class="s2">&quot;OpenXRTutorialChapter2&quot;</span><span class="p">)</span><span class="w"> </span><span class="c"># Needed for Android</span>
</pre></div>
</div>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="c"># For FetchContent_Declare() and FetchContent_MakeAvailable()</span>
<span class="nb">include</span><span class="p">(</span><span class="s">FetchContent</span><span class="p">)</span>

<span class="c"># openxr_loader - From github.com/KhronosGroup</span>
<span class="nb">set</span><span class="p">(</span><span class="s">BUILD_ALL_EXTENSIONS</span><span class="w"> </span><span class="s">ON</span><span class="w"> </span><span class="s">CACHE</span><span class="w"> </span><span class="s">INTERNAL</span><span class="w"> </span><span class="s2">&quot;Build loader and layers with all extensions&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">BUILD_TESTS</span><span class="w"> </span><span class="s">OFF</span><span class="w"> </span><span class="s">CACHE</span><span class="w"> </span><span class="s">INTERNAL</span><span class="w"> </span><span class="s2">&quot;Build tests&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">BUILD_CONFORMANCE_TESTS</span><span class="w"> </span><span class="s">OFF</span><span class="w"> </span><span class="s">CACHE</span><span class="w"> </span><span class="s">INTERNAL</span><span class="w"> </span><span class="s2">&quot;Build conformance tests&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">BUILD_API_LAYERS</span><span class="w"> </span><span class="s">ON</span><span class="w"> </span><span class="s">CACHE</span><span class="w"> </span><span class="s">INTERNAL</span><span class="w"> </span><span class="s2">&quot;Use OpenXR layers&quot;</span><span class="p">)</span>
<span class="nb">FetchContent_Declare</span><span class="p">(</span>
<span class="w">        </span><span class="s">OpenXR</span>
<span class="w">        </span><span class="c"># URL_HASH MD5=390455e9395a92d6b730afb8f23fac8e</span>
<span class="w">        </span><span class="c"># URL https://github.com/KhronosGroup/OpenXR-SDK-Source/archive/refs/tags/release-1.0.27.zip</span>
<span class="w">        </span><span class="s">URL_HASH</span><span class="w"> </span><span class="s">MD5=81930f0ccecdca852906e1a22aee4a45</span>
<span class="w">        </span><span class="s">URL</span><span class="w"> </span><span class="s">https://github.com/KhronosGroup/OpenXR-SDK-Source/archive/refs/tags/release-1.0.28.zip</span>
<span class="w">        </span><span class="s">DOWNLOAD_EXTRACT_TIMESTAMP</span><span class="w"> </span><span class="s">TRUE</span>
<span class="w">        </span><span class="s">SOURCE_DIR</span><span class="w"> </span><span class="s">openxr</span><span class="p">)</span>
<span class="nb">FetchContent_MakeAvailable</span><span class="p">(</span><span class="s">OpenXR</span><span class="p">)</span>
</pre></div>
</div>
<p>After setting our CMake version to 3.22.1 and the project‚Äôs name, we include <code class="docutils literal notranslate"><span class="pre">FetchContent</span></code> and use it to get the OpenXR-SDK from Khronos‚Äôs GitHub page.</p>
<div class="opengles docutils container" id="opengles-id-2">
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="c"># Files</span>
<span class="nb">set</span><span class="p">(</span><span class="s">SOURCES</span><span class="w"> </span>
<span class="w">    </span><span class="s2">&quot;main.cpp&quot;</span>
<span class="hll"><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI.cpp&quot;</span>
</span><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_D3D11.cpp&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_D3D12.cpp&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_OpenGL.cpp&quot;</span>
<span class="hll"><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_OpenGL_ES.cpp&quot;</span>
</span><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_Vulkan.cpp&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/OpenXRDebugUtils.cpp&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">HEADERS</span><span class="w"> </span>
<span class="w">    </span><span class="s2">&quot;../Common/DebugOutput.h&quot;</span>
<span class="hll"><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI.h&quot;</span>
</span><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_D3D11.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_D3D12.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_OpenGL.h&quot;</span>
<span class="hll"><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_OpenGL_ES.h&quot;</span>
</span><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_Vulkan.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/HelperFunctions.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/OpenXRDebugUtils.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/OpenXRHelper.h&quot;</span><span class="w"> </span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="vulkan docutils container" id="vulkan-id-6">
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="c"># Files</span>
<span class="nb">set</span><span class="p">(</span><span class="s">SOURCES</span><span class="w"> </span>
<span class="w">    </span><span class="s2">&quot;main.cpp&quot;</span>
<span class="hll"><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI.cpp&quot;</span>
</span><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_D3D11.cpp&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_D3D12.cpp&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_OpenGL.cpp&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_OpenGL_ES.cpp&quot;</span>
<span class="hll"><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_Vulkan.cpp&quot;</span>
</span><span class="w">    </span><span class="s2">&quot;../Common/OpenXRDebugUtils.cpp&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">HEADERS</span><span class="w"> </span>
<span class="w">    </span><span class="s2">&quot;../Common/DebugOutput.h&quot;</span>
<span class="hll"><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI.h&quot;</span>
</span><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_D3D11.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_D3D12.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_OpenGL.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_OpenGL_ES.h&quot;</span>
<span class="hll"><span class="w">    </span><span class="s2">&quot;../Common/GraphicsAPI_Vulkan.h&quot;</span>
</span><span class="w">    </span><span class="s2">&quot;../Common/HelperFunctions.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/OpenXRDebugUtils.h&quot;</span>
<span class="w">    </span><span class="s2">&quot;../Common/OpenXRHelper.h&quot;</span><span class="w"> </span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Here, we include all the files needed for our project. First, we‚Äôll create our source file called <code class="docutils literal notranslate"><span class="pre">main.cpp</span></code> in the <code class="docutils literal notranslate"><span class="pre">/Chapter2</span></code> directory. All files with <code class="docutils literal notranslate"><span class="pre">../Common/*.*</span></code> are available to download from this tutorial website. Below are the links and discussion of their usage within this tutorial and with OpenXR. This tutorial includes all the graphics APIs header and cpp files; you only need to download the files pertaining to your graphics API choice.</p>
<div class="opengles docutils container" id="opengles-id-3">
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_SHARED_LINKER_FLAGS</span><span class="w"> </span><span class="s2">&quot;${CMAKE_SHARED_LINKER_FLAGS} -u ANativeActivity_onCreate&quot;</span><span class="p">)</span><span class="w"> </span><span class="c"># export ANativeActivity_onCreate for java to call.</span>
<span class="nb">add_library</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">SHARED</span><span class="w"> </span><span class="o">${</span><span class="nv">SOURCES</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nv">HEADERS</span><span class="o">}</span><span class="p">)</span>
<span class="nb">target_include_directories</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="s2">&quot;../Common/&quot;</span><span class="p">)</span>

<span class="c"># native_app_glue</span>
<span class="nb">include</span><span class="p">(</span><span class="s">AndroidNdkModules</span><span class="p">)</span>
<span class="nb">android_ndk_import_module_native_app_glue</span><span class="p">()</span>

<span class="c"># vulkan - Found in the NDK</span>
<span class="nb">find_library</span><span class="p">(</span><span class="s">vulkan-lib</span><span class="w"> </span><span class="s">vulkan</span><span class="p">)</span>
<span class="nb">target_include_directories</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="o">${</span><span class="nv">ANDROID_NDK</span><span class="o">}</span><span class="s">/sources/third_party/vulkan/src/include</span><span class="p">)</span>

<span class="hll"><span class="c"># openxr-gfxwrapper - Manually build from OpenXR for OpenGL ES</span>
</span><span class="hll"><span class="nb">add_library</span><span class="p">(</span><span class="s">openxr-gfxwrapper</span><span class="w"> </span><span class="s">STATIC</span><span class="w"> </span><span class="o">${</span><span class="nv">openxr_SOURCE_DIR</span><span class="o">}</span><span class="s">/src/common/gfxwrapper_opengl.c</span><span class="w"> </span><span class="o">${</span><span class="nv">openxr_SOURCE_DIR</span><span class="o">}</span><span class="s">/src/common/gfxwrapper_opengl.h</span><span class="p">)</span>
</span><span class="hll"><span class="nb">target_include_directories</span><span class="p">(</span><span class="s">openxr-gfxwrapper</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="o">${</span><span class="nv">openxr_SOURCE_DIR</span><span class="o">}</span><span class="s">/external/include</span><span class="p">)</span>
</span><span class="hll"><span class="nb">find_library</span><span class="p">(</span><span class="s">GLES3-lib</span><span class="w"> </span><span class="s">GLESv3</span><span class="p">)</span>
</span><span class="hll"><span class="nb">find_library</span><span class="p">(</span><span class="s">EGL-lib</span><span class="w"> </span><span class="s">EGL</span><span class="p">)</span>
</span><span class="hll"><span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">openxr-gfxwrapper</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="o">${</span><span class="nv">GLES3-lib</span><span class="o">}</span><span class="p">)</span>
</span><span class="hll"><span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">openxr-gfxwrapper</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="o">${</span><span class="nv">EGL-lib</span><span class="o">}</span><span class="p">)</span>
</span><span class="hll">
</span><span class="hll"><span class="nb">target_include_directories</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="o">${</span><span class="nv">openxr_SOURCE_DIR</span><span class="o">}</span><span class="s">/src/common</span><span class="p">)</span>
</span><span class="hll"><span class="nb">target_include_directories</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="o">${</span><span class="nv">openxr_SOURCE_DIR</span><span class="o">}</span><span class="s">/external/include</span><span class="p">)</span>
</span>
<span class="c"># Final link</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span>
<span class="w">        </span><span class="s">android</span>
<span class="w">        </span><span class="s">native_app_glue</span>
<span class="w">        </span><span class="s">openxr_loader</span>
<span class="w">        </span><span class="o">${</span><span class="nv">vulkan-lib</span><span class="o">}</span>
<span class="hll"><span class="w">        </span><span class="s">openxr-gfxwrapper</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
<div class="vulkan docutils container" id="vulkan-id-7">
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_SHARED_LINKER_FLAGS</span><span class="w"> </span><span class="s2">&quot;${CMAKE_SHARED_LINKER_FLAGS} -u ANativeActivity_onCreate&quot;</span><span class="p">)</span><span class="w"> </span><span class="c"># export ANativeActivity_onCreate for java to call.</span>
<span class="nb">add_library</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">SHARED</span><span class="w"> </span><span class="o">${</span><span class="nv">SOURCES</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nv">HEADERS</span><span class="o">}</span><span class="p">)</span>
<span class="nb">target_include_directories</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="s2">&quot;../Common/&quot;</span><span class="p">)</span>

<span class="c"># native_app_glue</span>
<span class="nb">include</span><span class="p">(</span><span class="s">AndroidNdkModules</span><span class="p">)</span>
<span class="nb">android_ndk_import_module_native_app_glue</span><span class="p">()</span>

<span class="hll"><span class="c"># vulkan - Found in the NDK</span>
</span><span class="hll"><span class="nb">find_library</span><span class="p">(</span><span class="s">vulkan-lib</span><span class="w"> </span><span class="s">vulkan</span><span class="p">)</span>
</span><span class="hll"><span class="nb">target_include_directories</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="o">${</span><span class="nv">ANDROID_NDK</span><span class="o">}</span><span class="s">/sources/third_party/vulkan/src/include</span><span class="p">)</span>
</span>
<span class="c"># openxr-gfxwrapper - Manually build from OpenXR for OpenGL ES</span>
<span class="nb">add_library</span><span class="p">(</span><span class="s">openxr-gfxwrapper</span><span class="w"> </span><span class="s">STATIC</span><span class="w"> </span><span class="o">${</span><span class="nv">openxr_SOURCE_DIR</span><span class="o">}</span><span class="s">/src/common/gfxwrapper_opengl.c</span><span class="w"> </span><span class="o">${</span><span class="nv">openxr_SOURCE_DIR</span><span class="o">}</span><span class="s">/src/common/gfxwrapper_opengl.h</span><span class="p">)</span>
<span class="nb">target_include_directories</span><span class="p">(</span><span class="s">openxr-gfxwrapper</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="o">${</span><span class="nv">openxr_SOURCE_DIR</span><span class="o">}</span><span class="s">/external/include</span><span class="p">)</span>
<span class="nb">find_library</span><span class="p">(</span><span class="s">GLES3-lib</span><span class="w"> </span><span class="s">GLESv3</span><span class="p">)</span>
<span class="nb">find_library</span><span class="p">(</span><span class="s">EGL-lib</span><span class="w"> </span><span class="s">EGL</span><span class="p">)</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">openxr-gfxwrapper</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="o">${</span><span class="nv">GLES3-lib</span><span class="o">}</span><span class="p">)</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">openxr-gfxwrapper</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="o">${</span><span class="nv">EGL-lib</span><span class="o">}</span><span class="p">)</span>

<span class="nb">target_include_directories</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="o">${</span><span class="nv">openxr_SOURCE_DIR</span><span class="o">}</span><span class="s">/src/common</span><span class="p">)</span>
<span class="nb">target_include_directories</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="o">${</span><span class="nv">openxr_SOURCE_DIR</span><span class="o">}</span><span class="s">/external/include</span><span class="p">)</span>

<span class="c"># Final link</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">OpenXRTutorialChapter2</span>
<span class="w">        </span><span class="s">android</span>
<span class="w">        </span><span class="s">native_app_glue</span>
<span class="w">        </span><span class="s">openxr_loader</span>
<span class="hll"><span class="w">        </span><span class="o">${</span><span class="nv">vulkan-lib</span><span class="o">}</span>
</span><span class="w">        </span><span class="s">openxr-gfxwrapper</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now, we can set things up by adding a shared library with the <code class="docutils literal notranslate"><span class="pre">${SOURCES}</span></code> and <code class="docutils literal notranslate"><span class="pre">${HEADERS}</span></code>. We add the <code class="docutils literal notranslate"><span class="pre">../Common</span></code> folder as an include directory too. Just above that we need to set the <code class="docutils literal notranslate"><span class="pre">CMAKE_SHARED_LINKER_FLAGS</span></code> so that <code class="docutils literal notranslate"><span class="pre">ANativeActivity_onCreate()</span></code> is exported for the Java Virtual Machine to call. This is used by a static library called <code class="docutils literal notranslate"><span class="pre">native_app_glue</span></code>, which allows us to interface between the Java Virtual Machine and our C++ code. Ultimately, it allows us to use the <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">android_main(struct</span> <span class="pre">android_app*)</span></code> entry point.  We add <code class="docutils literal notranslate"><span class="pre">native_app_glue</span></code> to our project by including <code class="docutils literal notranslate"><span class="pre">AndroidNdkModules</span></code> and calling <code class="docutils literal notranslate"><span class="pre">android_ndk_import_module_native_app_glue()</span></code>.</p>
<p>Next, we find the Vulkan library in the NDK and include the directory to the Android Vulkan headers. We also add a static library called <code class="docutils literal notranslate"><span class="pre">openxr-gfxwrapper</span></code>, which will allow us to use OpenGL ES. We compile the library the C and header file in <code class="docutils literal notranslate"><span class="pre">${openxr_SOURCE_DIR}/src/common/gfxwrapper_opengl.*</span></code> and add this <code class="docutils literal notranslate"><span class="pre">${openxr_SOURCE_DIR}/external/include</span></code> as an include directory. Next, we find the <code class="docutils literal notranslate"><span class="pre">GLESv3</span></code> and <code class="docutils literal notranslate"><span class="pre">EGL</span></code> libraries and link them to <code class="docutils literal notranslate"><span class="pre">openxr-gfxwrapper</span></code>. We add the <code class="docutils literal notranslate"><span class="pre">${openxr_SOURCE_DIR}/src/common</span></code> and <code class="docutils literal notranslate"><span class="pre">${openxr_SOURCE_DIR}/external/include</span></code> folder as include directories to <code class="docutils literal notranslate"><span class="pre">OpenXRTutorialChapter2</span></code> as well.</p>
<p>Finally we link the <code class="docutils literal notranslate"><span class="pre">android</span></code>, <code class="docutils literal notranslate"><span class="pre">native_app_glue</span></code>, <code class="docutils literal notranslate"><span class="pre">openxr_loader</span></code>, <code class="docutils literal notranslate"><span class="pre">vulkan</span></code> and <code class="docutils literal notranslate"><span class="pre">openxr-gfxwrapper</span></code> libraries to our <code class="docutils literal notranslate"><span class="pre">OpenXRTutorialChapter2</span></code> library. Our <code class="docutils literal notranslate"><span class="pre">libOpenXRTutorialChapter2</span> <span class="pre">.so</span></code> will packaged inside our .apk along with any shared libraries that we have linked.</p>
<p class="rubric">AndroidManifest.xml</p>
<div class="highlight-udiff notranslate"><div class="highlight"><pre><span></span><span class="gd">--- G:\Jarvis\workspace\openxr-tutorial\openxr-tutorial-src\thirdparty\AndroidDefaultApp\app\src\main\AndroidManifest.xml</span>
<span class="gi">+++ G:\Jarvis\workspace\openxr-tutorial\openxr-tutorial-src\Chapter2\app\src\main\AndroidManifest.xml</span>
<span class="gu">@@ -1,23 +1,63 @@</span>
<span class="w"> </span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
<span class="w"> </span>&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
<span class="gd">-    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;</span>
<span class="gi">+    android:installLocation=&quot;auto&quot;</span>
<span class="gi">+    android:versionCode=&quot;1&quot;</span>
<span class="gi">+    android:versionName=&quot;1.0&quot;&gt;</span>
<span class="gi">+</span>
<span class="gi">+    &lt;!-- Require OpenGL ES 3.2 support. --&gt;</span>
<span class="gi">+    &lt;uses-feature</span>
<span class="gi">+        android:glEsVersion=&quot;0x00030002&quot;</span>
<span class="gi">+        android:required=&quot;true&quot; /&gt;</span>
<span class="gi">+</span>
<span class="gi">+    &lt;!-- Require Vulkan 1.0.3 support. --&gt;</span>
<span class="gi">+    &lt;uses-feature</span>
<span class="gi">+        android:name=&quot;android.hardware.vulkan.version&quot;</span>
<span class="gi">+        android:version=&quot;0x00400003&quot;</span>
<span class="gi">+        android:required=&quot;true&quot; /&gt;</span>
<span class="gi">+</span>
<span class="gi">+    &lt;!-- Tell Android that this application works in either 3DOF or 6DOF mode,</span>
<span class="gi">+     as well as on devices that are not all-in-ones. It must be set to false to allow</span>
<span class="gi">+     devices where the runtime was installed later to run the application. --&gt;</span>
<span class="gi">+    &lt;uses-feature</span>
<span class="gi">+        android:name=&quot;android.hardware.vr.headtracking&quot;</span>
<span class="gi">+        android:required=&quot;false&quot; /&gt;</span>
<span class="w"> </span>
<span class="w"> </span>    &lt;application
<span class="gd">-        android:allowBackup=&quot;true&quot;</span>
<span class="gd">-        android:dataExtractionRules=&quot;@xml/data_extraction_rules&quot;</span>
<span class="gd">-        android:fullBackupContent=&quot;@xml/backup_rules&quot;</span>
<span class="gi">+        android:allowBackup=&quot;false&quot;</span>
<span class="gi">+        android:fullBackupContent=&quot;false&quot;</span>
<span class="w"> </span>        android:icon=&quot;@mipmap/ic_launcher&quot;
<span class="w"> </span>        android:label=&quot;@string/app_name&quot;
<span class="gd">-        android:supportsRtl=&quot;true&quot;</span>
<span class="gd">-        android:theme=&quot;@style/Theme.MyApplication&quot;</span>
<span class="gd">-        tools:targetApi=&quot;31&quot;&gt;</span>
<span class="gi">+        android:roundIcon=&quot;@mipmap/ic_launcher_round&quot;</span>
<span class="gi">+        android:hasCode=&quot;false&quot;&gt; &lt;!-- There is no Java or Kotlin code in the application. --&gt;</span>
<span class="gi">+</span>
<span class="w"> </span>        &lt;activity
<span class="gd">-            android:name=&quot;.MainActivity&quot;</span>
<span class="gd">-            android:exported=&quot;true&quot;&gt;</span>
<span class="gi">+            android:name=&quot;android.app.NativeActivity&quot;</span>
<span class="gi">+            android:configChanges=&quot;screenSize|screenLayout|orientation|keyboardHidden|keyboard|navigation|uiMode&quot;</span>
<span class="gi">+            android:excludeFromRecents=&quot;false&quot;</span>
<span class="gi">+            android:exported=&quot;true&quot;</span>
<span class="gi">+            android:launchMode=&quot;singleTask&quot;</span>
<span class="gi">+            android:screenOrientation=&quot;landscape&quot;</span>
<span class="gi">+            android:theme=&quot;@android:style/Theme.Black.NoTitleBar.Fullscreen&quot;&gt;</span>
<span class="gi">+</span>
<span class="gi">+            &lt;!-- Tell NativeActivity the name of our .so. --&gt;</span>
<span class="gi">+            &lt;meta-data</span>
<span class="gi">+                android:name=&quot;android.app.lib_name&quot;</span>
<span class="gi">+                android:value=&quot;OpenXRTutorialChapter2&quot; /&gt;</span>
<span class="gi">+</span>
<span class="gi">+            &lt;!-- Standard Khronos OpenXR launcher intent filter. --&gt;</span>
<span class="w"> </span>            &lt;intent-filter&gt;
<span class="w"> </span>                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;
<span class="w"> </span>
<span class="w"> </span>                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;
<span class="gi">+                &lt;category android:name=&quot;org.khronos.openxr.intent.category.IMMERSIVE_HMD&quot; /&gt;</span>
<span class="gi">+            &lt;/intent-filter&gt;</span>
<span class="gi">+</span>
<span class="gi">+            &lt;!-- Meta Quest-specific non-standard intent filter. --&gt;</span>
<span class="gi">+            &lt;intent-filter&gt;</span>
<span class="gi">+                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;</span>
<span class="gi">+</span>
<span class="gi">+                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;</span>
<span class="gi">+                &lt;category android:name=&quot;com.oculus.intent.category.VR&quot; /&gt;</span>
<span class="w"> </span>            &lt;/intent-filter&gt;
<span class="w"> </span>        &lt;/activity&gt;
<span class="w"> </span>    &lt;/application&gt;
</pre></div>
</div>
<p>Download <a class="reference download internal" download="" href="_downloads/bddcfa7bd35c1ebeced195d715c62d91/AndroidManifest.xml"><code class="xref download docutils literal notranslate"><span class="pre">AndroidManifest.xml</span></code></a></p>
<p>We need to modify our <code class="docutils literal notranslate"><span class="pre">AndroidManifest.xml</span></code> file to allow our application to use the XR hardware. Above is a diff between our <code class="docutils literal notranslate"><span class="pre">AndroidManifest.xml</span></code> and the default one. Thing to note are:</p>
<ul class="simple">
<li><p>We add in a <code class="docutils literal notranslate"><span class="pre">&lt;uses-feature&gt;</span></code> to require OpenGL ES 3.2 and Vulkan 1.0.3 support.</p></li>
<li><p>Next, we add <code class="docutils literal notranslate"><span class="pre">&lt;uses-feature</span> <span class="pre">android:name=&quot;android.hardware.vr.headtracking&quot;</span> <span class="pre">android:required=&quot;false&quot;</span> <span class="pre">/&gt;</span></code> to specify that the application works with 3DOF or 6DOF and on devices that are not all-in-ones. It‚Äôs set to false so as to allow greater compatibility across devices.</p></li>
<li><p>We update the <code class="docutils literal notranslate"><span class="pre">&lt;application&gt;</span></code> section and add <code class="docutils literal notranslate"><span class="pre">android:hasCode=&quot;false&quot;</span></code> as there is no Java or Kotlin code in our application.</p></li>
<li><p>We also need to modify the <code class="docutils literal notranslate"><span class="pre">&lt;activity&gt;</span></code> section to tell Android to run this application as a Native Activity. We set <code class="docutils literal notranslate"><span class="pre">android:name</span></code> to <code class="docutils literal notranslate"><span class="pre">&quot;android.app.NativeActivity&quot;</span></code>.</p></li>
<li><p>Next, we add a <code class="docutils literal notranslate"><span class="pre">&lt;meta-data&gt;</span></code> section and add these values: <code class="docutils literal notranslate"><span class="pre">android:name=&quot;android.app.lib_name&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">android:value=&quot;OpenXRTutorialChapter2&quot;</span></code>, where <code class="docutils literal notranslate"><span class="pre">android:value</span></code> is name of the library we created in the CMakeLists, thus pointing our NativeActivity to the correct library.</p></li>
<li><p>Finally, We need update the <code class="docutils literal notranslate"><span class="pre">&lt;intent-filter&gt;</span></code> to tell the application that it should take over rendering when active, rather than appearing in a window. Set <code class="docutils literal notranslate"><span class="pre">&lt;category</span> <span class="pre">android:name=&quot;org.khronos.openxr.intent.category.IMMERSIVE_HMD&quot;</span> <span class="pre">/&gt;</span></code>. Note: not all devices yet support this <code class="docutils literal notranslate"><span class="pre">&lt;category&gt;</span></code>. For example, for Meta Quest devices you will need <code class="docutils literal notranslate"><span class="pre">&lt;category</span> <span class="pre">android:name=&quot;com.oculus.intent.category.VR&quot;</span> <span class="pre">/&gt;</span></code> for the same purpose. The code shows both the ‚ÄòStandard Khronos OpenXR‚Äô and ‚ÄòMeta Quest-specific non-standard‚Äô ways of setting the <code class="docutils literal notranslate"><span class="pre">&lt;intent-filter&gt;</span></code>.</p></li>
</ul>
<p class="rubric">Gradle</p>
<div class="highlight-udiff notranslate"><div class="highlight"><pre><span></span><span class="gd">--- G:\Jarvis\workspace\openxr-tutorial\openxr-tutorial-src\thirdparty\AndroidDefaultApp\app\build.gradle</span>
<span class="gi">+++ G:\Jarvis\workspace\openxr-tutorial\openxr-tutorial-src\Chapter2\app\build.gradle</span>
<span class="gu">@@ -1,20 +1,18 @@</span>
<span class="w"> </span>plugins {
<span class="w"> </span>    id &#39;com.android.application&#39;
<span class="gd">-    id &#39;org.jetbrains.kotlin.android&#39;</span>
<span class="w"> </span>}
<span class="w"> </span>
<span class="w"> </span>android {
<span class="w"> </span>    namespace &#39;com.simul.OpenXRTutorialChapter2&#39;
<span class="gd">-    compileSdk 33</span>
<span class="gi">+    compileSdk 29</span>
<span class="gi">+    ndkVersion &#39;23.1.7779620&#39;</span>
<span class="w"> </span>
<span class="w"> </span>    defaultConfig {
<span class="w"> </span>        applicationId &quot;com.simul.OpenXRTutorialChapter2&quot;
<span class="w"> </span>        minSdk 24
<span class="gd">-        targetSdk 33</span>
<span class="gi">+        targetSdk 29</span>
<span class="w"> </span>        versionCode 1
<span class="w"> </span>        versionName &quot;1.0&quot;
<span class="gd">-</span>
<span class="gd">-        testInstrumentationRunner &quot;androidx.test.runner.AndroidJUnitRunner&quot;</span>
<span class="w"> </span>    }
<span class="w"> </span>
<span class="w"> </span>    buildTypes {
<span class="gu">@@ -23,22 +21,20 @@</span>
<span class="w"> </span>            proguardFiles getDefaultProguardFile(&#39;proguard-android-optimize.txt&#39;), &#39;proguard-rules.pro&#39;
<span class="w"> </span>        }
<span class="w"> </span>    }
<span class="gd">-    compileOptions {</span>
<span class="gd">-        sourceCompatibility JavaVersion.VERSION_1_8</span>
<span class="gd">-        targetCompatibility JavaVersion.VERSION_1_8</span>
<span class="gi">+</span>
<span class="gi">+    externalNativeBuild {</span>
<span class="gi">+        cmake {</span>
<span class="gi">+            version &#39;3.22.1&#39;</span>
<span class="gi">+            path &#39;../CMakeLists.txt&#39;</span>
<span class="gi">+        }</span>
<span class="w"> </span>    }
<span class="gd">-    kotlinOptions {</span>
<span class="gd">-        jvmTarget = &#39;1.8&#39;</span>
<span class="gi">+</span>
<span class="gi">+    // Enable prefab support for the OpenXR AAR</span>
<span class="gi">+    buildFeatures {</span>
<span class="gi">+        prefab true</span>
<span class="w"> </span>    }
<span class="w"> </span>}
<span class="w"> </span>
<span class="w"> </span>dependencies {
<span class="gd">-</span>
<span class="gd">-    implementation &#39;androidx.core:core-ktx:1.7.0&#39;</span>
<span class="gd">-    implementation &#39;androidx.appcompat:appcompat:1.6.1&#39;</span>
<span class="gd">-    implementation &#39;com.google.android.material:material:1.9.0&#39;</span>
<span class="gd">-    implementation &#39;androidx.constraintlayout:constraintlayout:2.1.4&#39;</span>
<span class="gd">-    testImplementation &#39;junit:junit:4.13.2&#39;</span>
<span class="gd">-    androidTestImplementation &#39;androidx.test.ext:junit:1.1.5&#39;</span>
<span class="gd">-    androidTestImplementation &#39;androidx.test.espresso:espresso-core:3.5.1&#39;</span>
<span class="gi">+    implementation &#39;org.khronos.openxr:openxr_loader_for_android:1.0.28.2&#39;</span>
<span class="w"> </span>}
</pre></div>
</div>
<p>Download <a class="reference download internal" download="" href="_downloads/c4db202a67b23c0133445cae801a9425/build.gradle"><code class="xref download docutils literal notranslate"><span class="pre">app/build.gradle</span></code></a></p>
<p>Now, we can config our <code class="docutils literal notranslate"><span class="pre">build.gradle</span></code> file in the <code class="docutils literal notranslate"><span class="pre">app</span></code> folder to remove any references to Java, Kotlin and to testing. We also want to specify the the we are doing a <code class="docutils literal notranslate"><span class="pre">externalNativeBuild</span></code>  with CMake, along with the CMake version and the location of the <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> that we created earlier. We also specify the <code class="docutils literal notranslate"><span class="pre">ndkVersion</span></code>. Above is a diff between our <code class="docutils literal notranslate"><span class="pre">build.gradle</span></code> and the default one. Thing to note are:</p>
<ul class="simple">
<li><p>We remove any references to Java, Kotlin and to testing in the <code class="docutils literal notranslate"><span class="pre">plugins</span> <span class="pre">{}</span></code>, <code class="docutils literal notranslate"><span class="pre">android</span> <span class="pre">{</span> <span class="pre">defaultConfig</span> <span class="pre">{}</span> <span class="pre">}</span></code> sections and remove <code class="docutils literal notranslate"><span class="pre">compileOptions</span> <span class="pre">{}</span></code> and <code class="docutils literal notranslate"><span class="pre">kotlinOptions</span> <span class="pre">{}</span></code> sections entirely.</p></li>
<li><p>Update <code class="docutils literal notranslate"><span class="pre">compileSdk</span></code>, <code class="docutils literal notranslate"><span class="pre">minSdk</span></code> and <code class="docutils literal notranslate"><span class="pre">targetSdk</span></code> as shown. We specify <code class="docutils literal notranslate"><span class="pre">29</span></code> for the version, but any value great than or equal to <code class="docutils literal notranslate"><span class="pre">24</span></code> will work.</p></li>
<li><p>We specify the <code class="docutils literal notranslate"><span class="pre">ndkVersion</span></code> and add in an <code class="docutils literal notranslate"><span class="pre">externalNativeBuild</span> <span class="pre">{}</span></code> under the <code class="docutils literal notranslate"><span class="pre">android</span> <span class="pre">{}</span></code> section.  This specifies that we want to do an external native build with CMake and further specifies the version and the path to our <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code>. We also add <code class="docutils literal notranslate"><span class="pre">buildFeatures</span> <span class="pre">{</span> <span class="pre">prefab</span> <span class="pre">true</span> <span class="pre">}</span></code>. This allows the OpenXR loader AAR, specified in the <code class="docutils literal notranslate"><span class="pre">dependencies</span> <span class="pre">{}</span></code> section to work correctly.</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">dependencies</span> <span class="pre">{}</span></code> section remove all the existing entries and add <code class="docutils literal notranslate"><span class="pre">implementation</span> <span class="pre">'org.khronos.openxr:openxr_loader_for_android:...'</span></code>. This provides an <code class="docutils literal notranslate"><span class="pre">AndroidManifest.xml</span></code> that will be merged into our own, setting some required properties for the package and application. With this though, we are still required to add to our own <code class="docutils literal notranslate"><span class="pre">AndroidManifest.xml</span></code> file the relevant intent filters, such as <code class="docutils literal notranslate"><span class="pre">&lt;category</span> <span class="pre">android:name=&quot;org.khronos.openxr.intent.category.IMMERSIVE_HMD&quot;</span> <span class="pre">/&gt;</span></code>. It also provides the OpenXR headers and library binaries in a format that the Android Gradle Plugin will expose to CMake.</p></li>
</ul>
<div class="highlight-udiff notranslate"><div class="highlight"><pre><span></span><span class="gd">--- G:\Jarvis\workspace\openxr-tutorial\openxr-tutorial-src\thirdparty\AndroidDefaultApp\build.gradle</span>
<span class="gi">+++ G:\Jarvis\workspace\openxr-tutorial\openxr-tutorial-src\Chapter2\build.gradle</span>
<span class="gu">@@ -1,6 +1,9 @@</span>
<span class="w"> </span>// Top-level build file where you can add configuration options common to all sub-projects/modules.
<span class="w"> </span>plugins {
<span class="gd">-    id &#39;com.android.application&#39; version &#39;7.4.0&#39; apply false</span>
<span class="gd">-    id &#39;com.android.library&#39; version &#39;7.4.0&#39; apply false</span>
<span class="gd">-    id &#39;org.jetbrains.kotlin.android&#39; version &#39;1.7.21&#39; apply false</span>
<span class="gd">-}+    id &#39;com.android.application&#39; version &#39;7.4.2&#39; apply false</span>
<span class="gi">+}</span>
<span class="gi">+</span>
<span class="gi">+</span>
<span class="gi">+task clean(type: Delete) {</span>
<span class="gi">+    delete rootProject.buildDir</span>
<span class="gi">+}</span>
</pre></div>
</div>
<p>Download <a class="reference download internal" download="" href="_downloads/6f652dc898f3db4673cc2200f318d022/build.gradle"><code class="xref download docutils literal notranslate"><span class="pre">build.gradle</span></code></a></p>
<p>Now, we can config our <code class="docutils literal notranslate"><span class="pre">build.gradle</span></code> file in the <code class="docutils literal notranslate"><span class="pre">/Chapter2</span></code> folder. Above is a diff between our <code class="docutils literal notranslate"><span class="pre">build.gradle</span></code> and the default one. Update the <code class="docutils literal notranslate"><span class="pre">plugins</span> <span class="pre">{}</span></code> section and add the <code class="docutils literal notranslate"><span class="pre">task</span> <span class="pre">clean(type:</span> <span class="pre">Delete)</span> <span class="pre">{}</span></code> section.</p>
<p>In the <code class="docutils literal notranslate"><span class="pre">settings.gradle</span></code>, ensure that <code class="docutils literal notranslate"><span class="pre">include</span> <span class="pre">':app'</span></code> is included.</p>
<p>With that completed, we should now be able to sync the Gradle file and build the project.</p>
</div>
</section>
<section id="common-files">
<h3>1.4.2 Common Files<a class="headerlink" href="#common-files" title="Permalink to this heading">¬∂</a></h3>
<p>Now, that we have set up the project and source file. We will create a <code class="docutils literal notranslate"><span class="pre">/Common</span></code> folder with in the <em>workspace</em> directory. In that folder, we will add the following files. Below are all the files available to download:</p>
<section id="debugoutput">
<h4>DebugOutput<a class="headerlink" href="#debugoutput" title="Permalink to this heading">¬∂</a></h4>
<p><a class="reference download internal" download="" href="_downloads/a668d9f10e44c7f46a041356e11e3d9e/DebugOutput.h"><code class="xref download docutils literal notranslate"><span class="pre">DebugOutput.h</span></code></a></p>
<p><code class="docutils literal notranslate"><span class="pre">DebugOutput</span></code> is a class that redirects <code class="docutils literal notranslate"><span class="pre">std::cout</span></code> and <code class="docutils literal notranslate"><span class="pre">std::cerr</span></code> to the output window in your IDE.</p>
<div class="windows linux docutils container" id="windows-linux-id-2">
<p><code class="docutils literal notranslate"><span class="pre">DebugOutput</span></code> inherites from <code class="docutils literal notranslate"><span class="pre">vsBufferedStringStreamBuf</span></code>, which inherites from <code class="docutils literal notranslate"><span class="pre">std::streambuf</span></code>. <code class="docutils literal notranslate"><span class="pre">vsBufferedStringStreamBuf</span></code> queues the data from the redirected <code class="docutils literal notranslate"><span class="pre">std::streambuf</span></code> and calls <code class="docutils literal notranslate"><span class="pre">virtual</span> <span class="pre">void</span> <span class="pre">writeString(const</span> <span class="pre">std::string</span> <span class="pre">&amp;)</span></code>, which <code class="docutils literal notranslate"><span class="pre">DebugOutput</span></code> inplements as a call to <code class="docutils literal notranslate"><span class="pre">OutputDebugStringA()</span></code>.</p>
</div>
<div class="android docutils container" id="android-id-3">
<p><code class="docutils literal notranslate"><span class="pre">DebugOutput</span></code> inherites from <code class="docutils literal notranslate"><span class="pre">AndroidStreambuf</span></code>, which inherites from <code class="docutils literal notranslate"><span class="pre">std::streambuf</span></code>. <code class="docutils literal notranslate"><span class="pre">vsBufferedStringStreamBuf</span></code> queues the data from the redirected <code class="docutils literal notranslate"><span class="pre">std::streambuf</span></code> and calls <code class="docutils literal notranslate"><span class="pre">__android_log_write()</span></code> to log the message to Android Logcat.</p>
</div>
</section>
<section id="helperfunctions">
<h4>HelperFunctions<a class="headerlink" href="#helperfunctions" title="Permalink to this heading">¬∂</a></h4>
<p><a class="reference download internal" download="" href="_downloads/09fde4dd830aa0c1ae2771d8eff634c4/HelperFunctions.h"><code class="xref download docutils literal notranslate"><span class="pre">HelperFunctions.h</span></code></a></p>
<p>A simple header file for boilerplate code for the various platforms. It includes various C/C++ standard header, and the code that defines the macro <code class="docutils literal notranslate"><span class="pre">DEBUG_BREAK</span></code>, according to which platform we‚Äôre building for. This macro will stop execution of your program when an error occurs, so you can see where it happened and fix it. We use this macro in the <code class="docutils literal notranslate"><span class="pre">OpenXRMessageCallbackFunction()</span></code> function, which is discussed in detail in <a class="reference internal" href="5-extensions.html#using-xrcreatedebugutilsmessengerext"><span class="std std-ref">Chapter 5.2</span></a>.
<code class="docutils literal notranslate"><span class="pre">IsStringInVector()</span></code> and <code class="docutils literal notranslate"><span class="pre">BitwiseCheck()</span></code> are just simple wrappers over commonly used code. <code class="docutils literal notranslate"><span class="pre">IsStringInVector()</span></code> checks if a <code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">char</span> <span class="pre">*</span></code> is in a <code class="docutils literal notranslate"><span class="pre">std::vector&lt;const</span> <span class="pre">char</span> <span class="pre">*&gt;</span></code> by using <code class="docutils literal notranslate"><span class="pre">strcmp()</span></code>, and <code class="docutils literal notranslate"><span class="pre">BitwiseCheck()</span></code> checks if a bit is set in a bitfield.</p>
</section>
<section id="openxrdebugutils">
<h4>OpenXRDebugUtils<a class="headerlink" href="#openxrdebugutils" title="Permalink to this heading">¬∂</a></h4>
<p><a class="reference download internal" download="" href="_downloads/25292376df5afce45fe1df04d91fea9f/OpenXRDebugUtils.h"><code class="xref download docutils literal notranslate"><span class="pre">OpenXRDebugUtils.h</span></code></a></p>
<p><a class="reference download internal" download="" href="_downloads/f206e1c8599e8788f3b84b60d65b3396/OpenXRDebugUtils.cpp"><code class="xref download docutils literal notranslate"><span class="pre">OpenXRDebugUtils.cpp</span></code></a></p>
<p>A header and cpp file pair helps in setting up the DebugUtilsMessenger. <code class="docutils literal notranslate"><span class="pre">XR_EXT_debug_utils</span></code> in an OpenXR instance extension that can intercept call made to OpenXR and provide extra information or report warning and errors, if the usage of the API or the current state of OpenXR is not valid. As you go through this tutorial it is highly recommended to have this enable to help with debugging. This is discussed in detail in <a class="reference internal" href="5-extensions.html#using-xrcreatedebugutilsmessengerext"><span class="std std-ref">Chapter 5.2</span></a>, but in general <code class="docutils literal notranslate"><span class="pre">CreateOpenXRDebugUtilsMessenger()</span></code> creates and <code class="docutils literal notranslate"><span class="pre">DestroyOpenXRDebugUtilsMessenger()</span></code> destroys an <code class="docutils literal notranslate"><span class="pre">XrDebugUtilsMessengerEXT</span></code>. <code class="docutils literal notranslate"><span class="pre">OpenXRMessageCallbackFunction()</span></code> is a called function specified at object creation, which is used to call when OpenXR raises an issue. The header declares the functions and the cpp defines them.</p>
</section>
<section id="openxrhelper">
<h4>OpenXRHelper<a class="headerlink" href="#openxrhelper" title="Permalink to this heading">¬∂</a></h4>
<p><a class="reference download internal" download="" href="_downloads/07ed85d64fa8eeb958885d2b14115e3f/OpenXRHelper.h"><code class="xref download docutils literal notranslate"><span class="pre">OpenXRHelper.h</span></code></a></p>
<p>A header for including all the needed header files and helper functions.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Define any XR_USE_PLATFORM_... / XR_USE_GRAPHICS_API_... before this header file.</span>

<span class="c1">// OpenXR Headers</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;openxr/openxr.h&quot;</span>
<span class="hll"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;openxr/openxr_platform.h&quot;</span>
</span></pre></div>
</div>
<p>Here, we include the main OpenXR header file <code class="docutils literal notranslate"><span class="pre">openxr.h</span></code> and the OpenXR platform header file <code class="docutils literal notranslate"><span class="pre">openxr_platform.h</span></code>.
For the OpenXR platform header file, note the comment about using the preceding <code class="docutils literal notranslate"><span class="pre">XR_USE_PLATFORM_...</span></code> and <code class="docutils literal notranslate"><span class="pre">XR_USE_GRAPHICS_API_...</span></code> macros. When enabled, we gain access to functionality that interact with the chosen graphics API and/or platform. These macros are automatically set by <code class="docutils literal notranslate"><span class="pre">GraphicsAPI.h</span></code></p>
<p>This header also defines the macro <code class="docutils literal notranslate"><span class="pre">OPENXR_CHECK</span></code>. Many OpenXR functions return a <code class="docutils literal notranslate"><span class="pre">XrResult</span></code>. This macro will check if the call has failed and logs a message to <code class="docutils literal notranslate"><span class="pre">std::cerr</span></code>. This can be modified to suit your needs. There are two additional functions <code class="docutils literal notranslate"><span class="pre">GetXRErrorString()</span></code> and <code class="docutils literal notranslate"><span class="pre">OpenXRDebugBreak()</span></code>, which are used to convert the <code class="docutils literal notranslate"><span class="pre">XrResult</span></code> to a string and as a breakpoint function respectively.</p>
</section>
<section id="graphicsapi">
<h4>GraphicsAPI<a class="headerlink" href="#graphicsapi" title="Permalink to this heading">¬∂</a></h4>
<p><a class="reference download internal" download="" href="_downloads/ee7900b1ff1ef2d947bd578e417c62db/GraphicsAPI.h"><code class="xref download docutils literal notranslate"><span class="pre">GraphicsAPI.h</span></code></a></p>
<p><a class="reference download internal" download="" href="_downloads/c4b96771e22873e9c1d09d729dea1bd2/GraphicsAPI.cpp"><code class="xref download docutils literal notranslate"><span class="pre">GraphicsAPI.cpp</span></code></a></p>
<div class="d3d11 docutils container" id="d3d11-id-3">
<p class="rubric">Direct3D 11</p>
<p><a class="reference download internal" download="" href="_downloads/bda9ce781466ec0c60e8787d9185fe07/GraphicsAPI_D3D11.h"><code class="xref download docutils literal notranslate"><span class="pre">GraphicsAPI_D3D11.h</span></code></a></p>
<p><a class="reference download internal" download="" href="_downloads/f8f459fcb383e571f9e8ec353b26ac2c/GraphicsAPI_D3D11.cpp"><code class="xref download docutils literal notranslate"><span class="pre">GraphicsAPI_D3D11.cpp</span></code></a></p>
</div>
<div class="d3d12 docutils container" id="d3d12-id-3">
<p class="rubric">DirectX 12</p>
<p><a class="reference download internal" download="" href="_downloads/3842d2de6eb1b2797b794ec09fd778aa/GraphicsAPI_D3D12.h"><code class="xref download docutils literal notranslate"><span class="pre">GraphicsAPI_D3D12.h</span></code></a></p>
<p><a class="reference download internal" download="" href="_downloads/e083cc61d81b06c1405b149812da5240/GraphicsAPI_D3D12.cpp"><code class="xref download docutils literal notranslate"><span class="pre">GraphicsAPI_D3D12.cpp</span></code></a></p>
</div>
<div class="opengl docutils container" id="opengl-id-5">
<p class="rubric">OpenGL</p>
<p><a class="reference download internal" download="" href="_downloads/6ecf914e43c32a3fbf68265b4c70d1b6/GraphicsAPI_OpenGL.h"><code class="xref download docutils literal notranslate"><span class="pre">GraphicsAPI_OpenGL.h</span></code></a></p>
<p><a class="reference download internal" download="" href="_downloads/4ab2a28ab4cc788086acc7ac599bcbe3/GraphicsAPI_OpenGL.cpp"><code class="xref download docutils literal notranslate"><span class="pre">GraphicsAPI_OpenGL.cpp</span></code></a></p>
</div>
<div class="opengles docutils container" id="opengles-id-4">
<p class="rubric">OpenGL ES</p>
<p><a class="reference download internal" download="" href="_downloads/18dfa0ecf88e53b145e4bf884b70ce69/GraphicsAPI_OpenGL_ES.h"><code class="xref download docutils literal notranslate"><span class="pre">GraphicsAPI_OpenGL_ES.h</span></code></a></p>
<p><a class="reference download internal" download="" href="_downloads/15d84956ee41d048b0020d480a776d56/GraphicsAPI_OpenGL_ES.cpp"><code class="xref download docutils literal notranslate"><span class="pre">GraphicsAPI_OpenGL_ES.cpp</span></code></a></p>
</div>
<div class="vulkan docutils container" id="vulkan-id-8">
<p class="rubric">Vulkan</p>
<p><a class="reference download internal" download="" href="_downloads/7e1287eebafcf47fda72c8aaf562283d/GraphicsAPI_Vulkan.h"><code class="xref download docutils literal notranslate"><span class="pre">GraphicsAPI_Vulkan.h</span></code></a></p>
<p><a class="reference download internal" download="" href="_downloads/ac69bef9a1770690c3db93d34147b297/GraphicsAPI_Vulkan.cpp"><code class="xref download docutils literal notranslate"><span class="pre">GraphicsAPI_Vulkan.cpp</span></code></a></p>
</div>
<p>This tutorial uses polymorphic classes; <code class="docutils literal notranslate"><span class="pre">GraphicsAPI_...</span></code> derives from the base <code class="docutils literal notranslate"><span class="pre">GraphicsAPI</span></code> class. The derived class is based on your graphics API selection. Include both the header and cpp files for both <code class="docutils literal notranslate"><span class="pre">GraphicsAPI</span></code> and <code class="docutils literal notranslate"><span class="pre">GraphicsAPI...</span></code>. <code class="docutils literal notranslate"><span class="pre">GraphicsAPI.h</span></code> includes the headers and macros needed to set up your platform and graphics API. Below are code snippets that show how to set up the <code class="docutils literal notranslate"><span class="pre">XR_USE_PLATFORM_...</span></code> and <code class="docutils literal notranslate"><span class="pre">XR_USE_GRAPHICS_API_...</span></code> macros for your platform along with any relevant headers. This tutorial demonstrates all five graphics APIs, you will only need to select one <code class="docutils literal notranslate"><span class="pre">XR_USE_PLATFORM_...</span></code> macro and one <code class="docutils literal notranslate"><span class="pre">XR_USE_GRAPHICS_API_...</span></code> macro.</p>
<p>The code below is an example of how you might implement the inclusion and definition the relevant graphics API header along with the <code class="docutils literal notranslate"><span class="pre">XR_USE_PLATFORM_...</span></code> and <code class="docutils literal notranslate"><span class="pre">XR_USE_GRAPHICS_API_...</span></code> macros. This will already be set up in the <code class="docutils literal notranslate"><span class="pre">GraphicsAPI.h</span></code> file.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;HelperFunctions.h&quot;</span>
</pre></div>
</div>
<div class="windows docutils container" id="windows-id-3">
<div class="d3d11 docutils container" id="d3d11-id-4">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#if defined(_WIN32)</span>
<span class="cp">#define WIN32_LEAN_AND_MEAN</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Windows.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;unknwn.h&quot;</span>
<span class="hll"><span class="cp">#define XR_USE_PLATFORM_WIN32</span>
</span>
<span class="hll"><span class="cp">#define XR_USE_GRAPHICS_API_D3D11</span>
</span><span class="cp">#define XR_USE_GRAPHICS_API_D3D12</span>
<span class="cp">#define XR_USE_GRAPHICS_API_OPENGL</span>
<span class="cp">#define XR_USE_GRAPHICS_API_VULKAN</span>
<span class="cp">#endif</span>
</pre></div>
</div>
</div>
<div class="d3d12 docutils container" id="d3d12-id-4">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#if defined(_WIN32)</span>
<span class="cp">#define WIN32_LEAN_AND_MEAN</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Windows.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;unknwn.h&quot;</span>
<span class="hll"><span class="cp">#define XR_USE_PLATFORM_WIN32</span>
</span>
<span class="cp">#define XR_USE_GRAPHICS_API_D3D11</span>
<span class="hll"><span class="cp">#define XR_USE_GRAPHICS_API_D3D12</span>
</span><span class="cp">#define XR_USE_GRAPHICS_API_OPENGL</span>
<span class="cp">#define XR_USE_GRAPHICS_API_VULKAN</span>
<span class="cp">#endif</span>
</pre></div>
</div>
</div>
<div class="opengl docutils container" id="opengl-id-6">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#if defined(_WIN32)</span>
<span class="cp">#define WIN32_LEAN_AND_MEAN</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Windows.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;unknwn.h&quot;</span>
<span class="hll"><span class="cp">#define XR_USE_PLATFORM_WIN32</span>
</span>
<span class="cp">#define XR_USE_GRAPHICS_API_D3D11</span>
<span class="cp">#define XR_USE_GRAPHICS_API_D3D12</span>
<span class="hll"><span class="cp">#define XR_USE_GRAPHICS_API_OPENGL</span>
</span><span class="cp">#define XR_USE_GRAPHICS_API_VULKAN</span>
<span class="cp">#endif</span>
</pre></div>
</div>
</div>
<div class="vulkan docutils container" id="vulkan-id-9">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#if defined(_WIN32)</span>
<span class="cp">#define WIN32_LEAN_AND_MEAN</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Windows.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;unknwn.h&quot;</span>
<span class="hll"><span class="cp">#define XR_USE_PLATFORM_WIN32</span>
</span>
<span class="cp">#define XR_USE_GRAPHICS_API_D3D11</span>
<span class="cp">#define XR_USE_GRAPHICS_API_D3D12</span>
<span class="cp">#define XR_USE_GRAPHICS_API_OPENGL</span>
<span class="hll"><span class="cp">#define XR_USE_GRAPHICS_API_VULKAN</span>
</span><span class="cp">#endif</span>
</pre></div>
</div>
</div>
</div>
<div class="linux docutils container" id="linux-id-3">
<div class="opengl docutils container" id="opengl-id-7">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#if defined(__LINIX__)</span>
<span class="hll"><span class="cp">#define XR_USE_PLATFORM_XLIB</span>
</span><span class="hll"><span class="cp">#define XR_USE_PLATFORM_XCB</span>
</span><span class="hll"><span class="cp">#define XR_USE_PLATFORM_WAYLAND</span>
</span>
<span class="hll"><span class="cp">#define XR_USE_GRAPHICS_API_OPENGL</span>
</span><span class="cp">#define XR_USE_GRAPHICS_API_VULKAN</span>
<span class="cp">#endif</span>
</pre></div>
</div>
</div>
<div class="vulkan docutils container" id="vulkan-id-10">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#if defined(__LINIX__)</span>
<span class="hll"><span class="cp">#define XR_USE_PLATFORM_XLIB</span>
</span><span class="hll"><span class="cp">#define XR_USE_PLATFORM_XCB</span>
</span><span class="hll"><span class="cp">#define XR_USE_PLATFORM_WAYLAND</span>
</span>
<span class="cp">#define XR_USE_GRAPHICS_API_OPENGL</span>
<span class="hll"><span class="cp">#define XR_USE_GRAPHICS_API_VULKAN</span>
</span><span class="cp">#endif</span>
</pre></div>
</div>
</div>
</div>
<div class="android docutils container" id="android-id-4">
<div class="opengles docutils container" id="opengles-id-5">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#if defined(__ANDROID__)</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;android_native_app_glue.h&quot;</span>
<span class="hll"><span class="cp">#define XR_USE_PLATFORM_ANDROID</span>
</span>
<span class="hll"><span class="cp">#define XR_USE_GRAPHICS_API_OPENGL_ES</span>
</span><span class="cp">#define XR_USE_GRAPHICS_API_VULKAN</span>
<span class="cp">#endif</span>
</pre></div>
</div>
</div>
<div class="vulkan docutils container" id="vulkan-id-11">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#if defined(__ANDROID__)</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;android_native_app_glue.h&quot;</span>
<span class="hll"><span class="cp">#define XR_USE_PLATFORM_ANDROID</span>
</span>
<span class="cp">#define XR_USE_GRAPHICS_API_OPENGL_ES</span>
<span class="hll"><span class="cp">#define XR_USE_GRAPHICS_API_VULKAN</span>
</span><span class="cp">#endif</span>
</pre></div>
</div>
</div>
</div>
<div class="d3d11 docutils container" id="d3d11-id-5">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#if defined(XR_USE_GRAPHICS_API_D3D11)</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;d3d11.h&gt;</span>
<span class="cp">#endif</span>
</pre></div>
</div>
</div>
<div class="d3d12 docutils container" id="d3d12-id-5">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#if defined(XR_USE_GRAPHICS_API_D3D12)</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;d3d12.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;dxgi1_6.h&gt;</span>
<span class="cp">#endif</span>
</pre></div>
</div>
</div>
<div class="opengl docutils container" id="opengl-id-8">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#if defined(XR_USE_GRAPHICS_API_OPENGL)</span>
<span class="c1">// gfxwrapper will redefine these macros</span>
<span class="cp">#undef XR_USE_PLATFORM_WIN32</span>
<span class="cp">#undef XR_USE_PLATFORM_XLIB</span>
<span class="cp">#undef XR_USE_PLATFORM_XCB</span>
<span class="cp">#undef XR_USE_PLATFORM_WAYLAND</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;gfxwrapper_opengl.h&quot;</span>
<span class="cp">#endif</span>
</pre></div>
</div>
</div>
<div class="opengles docutils container" id="opengles-id-6">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#if defined(XR_USE_GRAPHICS_API_OPENGL_ES)</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;gfxwrapper_opengl.h&quot;</span>
<span class="cp">#endif</span>
</pre></div>
</div>
</div>
<div class="vulkan docutils container" id="vulkan-id-12">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#if defined(XR_USE_GRAPHICS_API_VULKAN)</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;vulkan/vulkan.h&quot;</span>
<span class="cp">#endif</span>
</pre></div>
</div>
</div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// OpenXR</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;OpenXRHelper.h&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="openxrtutorial-and-main">
<h3>1.4.3 OpenXRTutorial and Main<a class="headerlink" href="#openxrtutorial-and-main" title="Permalink to this heading">¬∂</a></h3>
<p>We can now start adding code to our <code class="docutils literal notranslate"><span class="pre">main.cpp</span></code> file that we have created in the <code class="docutils literal notranslate"><span class="pre">Chapter2/</span></code> folder. Open <code class="docutils literal notranslate"><span class="pre">main.cpp</span></code> text file with Visual Studio. We will just use Visual Studio to edit the file and we will later set up the project files with CMake.</p>
<p>First, we add <code class="docutils literal notranslate"><span class="pre">DebugOutput.h</span></code>:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;DebugOutput.h&quot;</span>
</pre></div>
</div>
<p>Next, we add the <code class="docutils literal notranslate"><span class="pre">GraphicsAPI_....h</span></code> header to include the Graphics API code of your chosen graphics API. This will in turn include <code class="docutils literal notranslate"><span class="pre">GraphicsAPI.h</span></code>, <code class="docutils literal notranslate"><span class="pre">HelperFunctions.h</span></code>  and <code class="docutils literal notranslate"><span class="pre">OpenXRHelper.h</span></code>. In this tutorial, we include all of them, though you would only be picking one.</p>
<div class="d3d11 docutils container" id="d3d11-id-6">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GraphicsAPI_D3D11.h&quot;</span>
</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GraphicsAPI_D3D12.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GraphicsAPI_OpenGL.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GraphicsAPI_OpenGL_ES.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GraphicsAPI_Vulkan.h&quot;</span>
</pre></div>
</div>
</div>
<div class="d3d12 docutils container" id="d3d12-id-6">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GraphicsAPI_D3D11.h&quot;</span>
<span class="hll"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GraphicsAPI_D3D12.h&quot;</span>
</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GraphicsAPI_OpenGL.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GraphicsAPI_OpenGL_ES.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GraphicsAPI_Vulkan.h&quot;</span>
</pre></div>
</div>
</div>
<div class="opengl docutils container" id="opengl-id-9">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GraphicsAPI_D3D11.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GraphicsAPI_D3D12.h&quot;</span>
<span class="hll"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GraphicsAPI_OpenGL.h&quot;</span>
</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GraphicsAPI_OpenGL_ES.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GraphicsAPI_Vulkan.h&quot;</span>
</pre></div>
</div>
</div>
<div class="opengles docutils container" id="opengles-id-7">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GraphicsAPI_D3D11.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GraphicsAPI_D3D12.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GraphicsAPI_OpenGL.h&quot;</span>
<span class="hll"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GraphicsAPI_OpenGL_ES.h&quot;</span>
</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GraphicsAPI_Vulkan.h&quot;</span>
</pre></div>
</div>
</div>
<div class="vulkan docutils container" id="vulkan-id-13">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GraphicsAPI_D3D11.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GraphicsAPI_D3D12.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GraphicsAPI_OpenGL.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GraphicsAPI_OpenGL_ES.h&quot;</span>
<span class="hll"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GraphicsAPI_Vulkan.h&quot;</span>
</span></pre></div>
</div>
</div>
<p>You can also include <code class="docutils literal notranslate"><span class="pre">OpenXRDebugUtils.h</span></code> to help with set up of <code class="docutils literal notranslate"><span class="pre">XrDebugUtilsMessengerEXT</span></code>.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;OpenXRDebugUtils.h&quot;</span>
</pre></div>
</div>
<p>Now we will define the main class <code class="docutils literal notranslate"><span class="pre">OpenXRTutorial</span></code> of the application. It‚Äôs just a stub for now, with an empty <code class="docutils literal notranslate"><span class="pre">Run()</span></code> method:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">OpenXRTutorial</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">        </span><span class="n">OpenXRTutorial</span><span class="p">(</span><span class="n">GraphicsAPI_Type</span><span class="w"> </span><span class="n">apiType</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="o">~</span><span class="n">OpenXRTutorial</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>

<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">Run</span><span class="p">()</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">        </span><span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Finally, let‚Äôs add the main function for the application. It will look slightly different, depending on your
chosen platform. We first create a ‚Äòpseudo-main function‚Äô called <code class="docutils literal notranslate"><span class="pre">OpenXRTutorial_Main()</span></code>, in which we create an instance of our <code class="docutils literal notranslate"><span class="pre">OpenXRTutorial</span></code> class, taking a <code class="docutils literal notranslate"><span class="pre">GraphicsAPI_Type</span></code> parameter, and call the <code class="docutils literal notranslate"><span class="pre">Run()</span></code> method. <code class="docutils literal notranslate"><span class="pre">GraphicsAPI_Type</span></code> can be changed to suit the graphics API that you have chosen.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">OpenXRTutorial_Main</span><span class="p">(</span><span class="n">GraphicsAPI_Type</span><span class="w"> </span><span class="n">api</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">DebugOutput</span><span class="w"> </span><span class="n">debugOutput</span><span class="p">;</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;OpenXR Tutorial Chapter 2.&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

<span class="w">    </span><span class="n">OpenXRTutorial</span><span class="w"> </span><span class="n">app</span><span class="p">(</span><span class="n">api</span><span class="p">);</span>
<span class="w">    </span><span class="n">app</span><span class="p">.</span><span class="n">Run</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Then, we create the actual platform specific main function (our entry point to the application), which will call <code class="docutils literal notranslate"><span class="pre">OpenXRTutorial_Main()</span></code> with our <code class="docutils literal notranslate"><span class="pre">GraphicsAPI_Type</span></code> parameter. By default, this tutorial uses <code class="docutils literal notranslate"><span class="pre">OPENGL</span></code> as the parameter to <code class="docutils literal notranslate"><span class="pre">OpenXRTutorial_Main()</span></code>. This must be changed to match on your chosen graphics API.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">enum</span><span class="w"> </span><span class="nc">GraphicsAPI_Type</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UNKNOWN</span><span class="p">,</span>
<span class="w">    </span><span class="n">D3D11</span><span class="p">,</span>
<span class="w">    </span><span class="n">D3D12</span><span class="p">,</span>
<span class="w">    </span><span class="n">OPENGL</span><span class="p">,</span>
<span class="w">    </span><span class="n">OPENGL_ES</span><span class="p">,</span>
<span class="w">    </span><span class="n">VULKAN</span>
<span class="p">};</span>
</pre></div>
</div>
<div class="windows linux docutils container" id="windows-linux-id-3">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">OpenXRTutorial_Main</span><span class="p">(</span><span class="n">OPENGL</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="android docutils container" id="android-id-5">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">android_app</span><span class="w"> </span><span class="o">*</span><span class="n">OpenXRTutorial</span><span class="o">::</span><span class="n">androidApp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="n">OpenXRTutorial</span><span class="o">::</span><span class="n">AndroidAppState</span><span class="w"> </span><span class="n">OpenXRTutorial</span><span class="o">::</span><span class="n">androidAppState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">android_main</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">android_app</span><span class="w"> </span><span class="o">*</span><span class="n">app</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Allow interaction with JNI and the JVM on this thread.</span>
<span class="w">    </span><span class="c1">// https://developer.android.com/training/articles/perf-jni#threads</span>
<span class="w">    </span><span class="n">JNIEnv</span><span class="w"> </span><span class="o">*</span><span class="n">env</span><span class="p">;</span>
<span class="w">    </span><span class="n">app</span><span class="o">-&gt;</span><span class="n">activity</span><span class="o">-&gt;</span><span class="n">vm</span><span class="o">-&gt;</span><span class="n">AttachCurrentThread</span><span class="p">(</span><span class="o">&amp;</span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">);</span>

<span class="w">    </span><span class="n">XrInstance</span><span class="w"> </span><span class="n">m_xrInstance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">XR_NULL_HANDLE</span><span class="p">;</span><span class="w">  </span><span class="c1">// Dummy XrInstance variable for OPENXR_CHECK macro.</span>
<span class="w">    </span><span class="n">PFN_xrInitializeLoaderKHR</span><span class="w"> </span><span class="n">xrInitializeLoaderKHR</span><span class="p">;</span>
<span class="w">    </span><span class="n">OPENXR_CHECK</span><span class="p">(</span><span class="n">xrGetInstanceProcAddr</span><span class="p">(</span><span class="n">XR_NULL_HANDLE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;xrInitializeLoaderKHR&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">PFN_xrVoidFunction</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">xrInitializeLoaderKHR</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Failed to get InstanceProcAddr.&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">xrInitializeLoaderKHR</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">XrLoaderInitInfoAndroidKHR</span><span class="w"> </span><span class="n">loaderInitializeInfoAndroid</span><span class="p">{</span><span class="n">XR_TYPE_LOADER_INIT_INFO_ANDROID_KHR</span><span class="p">};</span>
<span class="w">    </span><span class="n">loaderInitializeInfoAndroid</span><span class="p">.</span><span class="n">applicationVM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">app</span><span class="o">-&gt;</span><span class="n">activity</span><span class="o">-&gt;</span><span class="n">vm</span><span class="p">;</span>
<span class="w">    </span><span class="n">loaderInitializeInfoAndroid</span><span class="p">.</span><span class="n">applicationContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">app</span><span class="o">-&gt;</span><span class="n">activity</span><span class="o">-&gt;</span><span class="n">clazz</span><span class="p">;</span>
<span class="w">    </span><span class="n">OPENXR_CHECK</span><span class="p">(</span><span class="n">xrInitializeLoaderKHR</span><span class="p">((</span><span class="n">XrLoaderInitInfoBaseHeaderKHR</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">loaderInitializeInfoAndroid</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Failed to initialise Loader for Android.&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="n">app</span><span class="o">-&gt;</span><span class="n">userData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">OpenXRTutorial</span><span class="o">::</span><span class="n">androidAppState</span><span class="p">;</span>
<span class="w">    </span><span class="n">app</span><span class="o">-&gt;</span><span class="n">onAppCmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OpenXRTutorial</span><span class="o">::</span><span class="n">AndroidAppHandleCmd</span><span class="p">;</span>

<span class="w">    </span><span class="n">OpenXRTutorial</span><span class="o">::</span><span class="n">androidApp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">app</span><span class="p">;</span>
<span class="w">    </span><span class="n">OpenXRTutorial_Main</span><span class="p">(</span><span class="n">OPENGL_ES</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Android requires a few extra additions to the class. Namely, <code class="docutils literal notranslate"><span class="pre">android_app</span> <span class="pre">*</span></code>, <code class="docutils literal notranslate"><span class="pre">AndroidAppState</span></code> and <code class="docutils literal notranslate"><span class="pre">AndroidAppHandleCmd</span></code>, which are used in getting updates from the Android Operating System and keep our application functioning.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">android_app</span><span class="w"> </span><span class="o">*</span><span class="n">androidApp</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Modified from https://github.com/KhronosGroup/OpenXR-SDK-Source/blob/d6b6d7a10bdcf8d4fe806b4f415fde3dd5726878/src/tests/hello_xr/main.cpp#L133C1-L189C2</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">AndroidAppState</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ANativeWindow</span><span class="w"> </span><span class="o">*</span><span class="n">nativeWindow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="n">resumed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">AndroidAppState</span><span class="w"> </span><span class="n">androidAppState</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Process the next main command.</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">AndroidAppHandleCmd</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">android_app</span><span class="w"> </span><span class="o">*</span><span class="n">app</span><span class="p">,</span><span class="w"> </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">cmd</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">AndroidAppState</span><span class="w"> </span><span class="o">*</span><span class="n">appState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">AndroidAppState</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">app</span><span class="o">-&gt;</span><span class="n">userData</span><span class="p">;</span>

<span class="w">        </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// There is no APP_CMD_CREATE. The ANativeActivity creates the application thread from onCreate().</span>
<span class="w">        </span><span class="c1">// The application thread then calls android_main().</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="no">APP_CMD_START</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="no">APP_CMD_RESUME</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">appState</span><span class="o">-&gt;</span><span class="n">resumed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="no">APP_CMD_PAUSE</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">appState</span><span class="o">-&gt;</span><span class="n">resumed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="no">APP_CMD_STOP</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="no">APP_CMD_DESTROY</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">appState</span><span class="o">-&gt;</span><span class="n">nativeWindow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="no">APP_CMD_INIT_WINDOW</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">appState</span><span class="o">-&gt;</span><span class="n">nativeWindow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">app</span><span class="o">-&gt;</span><span class="n">window</span><span class="p">;</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="no">APP_CMD_TERM_WINDOW</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">appState</span><span class="o">-&gt;</span><span class="n">nativeWindow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="k">private</span><span class="o">:</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">PollSystemEvents</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">androidApp</span><span class="o">-&gt;</span><span class="n">destroyRequested</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">m_applicationRunning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">            </span><span class="k">return</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">struct</span><span class="w"> </span><span class="nc">android_poll_source</span><span class="w"> </span><span class="o">*</span><span class="n">source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">events</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">            </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">timeoutMilliseconds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">androidAppState</span><span class="p">.</span><span class="n">resumed</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">m_sessionRunning</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">androidApp</span><span class="o">-&gt;</span><span class="n">destroyRequested</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">-1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ALooper_pollAll</span><span class="p">(</span><span class="n">timeoutMilliseconds</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">events</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">**</span><span class="p">)</span><span class="o">&amp;</span><span class="n">source</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">source</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">source</span><span class="o">-&gt;</span><span class="n">process</span><span class="p">(</span><span class="n">androidApp</span><span class="p">,</span><span class="w"> </span><span class="n">source</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
<p>Before we can use OpenXR for Android, we need to initialise the loader based the application‚Äôs context and virtual machine. We retrieve the function pointer to <code class="docutils literal notranslate"><span class="pre">xrInitializeLoaderKHR</span></code>, and with the <code class="docutils literal notranslate"><span class="pre">XrLoaderInitInfoAndroidKHR</span></code> filled out call that function to initialise OpenXR for our use. At this point, we also attach the current thread to the Java Virtual Machine. We assign our <code class="docutils literal notranslate"><span class="pre">AndroidAppState</span></code> static member and our <code class="docutils literal notranslate"><span class="pre">AndroidAppHandleCmd()</span></code> static method to the <code class="docutils literal notranslate"><span class="pre">android_app</span> <span class="pre">*</span></code> and save it to a static member in the class.</p>
</div>
</section>
<section id="build-and-run">
<h3>1.4.4 Build and Run<a class="headerlink" href="#build-and-run" title="Permalink to this heading">¬∂</a></h3>
<div class="windows docutils container" id="windows-id-4">
<p>In the <em>workspace</em> directory, create a <code class="docutils literal notranslate"><span class="pre">build/</span></code> folder, which will contain our project, solution and output binary files. Now launch the CMake GUI, and point the ‚ÄúWhere is the source code‚Äù box to the <em>workspace</em> directory, where your original <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> is located. Point the ‚ÄúWhere to build the binaries‚Äù box to a subdirectory called <code class="docutils literal notranslate"><span class="pre">build</span></code>, that we have just created. Click ‚ÄúConfigure‚Äù and ‚ÄúOK‚Äù to accept the default Generator, then click ‚ÄúGenerate‚Äù to create the Visual Studio solution and project. Finally click ‚ÄúOpen Project‚Äù to open that solution with Visual Studio.</p>
<p>You can now build and run your program. It should compile and link with no errors or warnings.</p>
</div>
<div class="linux docutils container" id="linux-id-4">
<p>You now have the files and folders, laid out as follows:</p>
<figure class="align-default">
<img alt="Initial files in VS Code" src="_images/linux-vscode-initial-files.png" />
</figure>
<p>Having installed the CMake extension for Visual Studio Code, you can now right-click on the main <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> file (the one in the root <em>workspace</em> folder). We can select ‚ÄúConfigure and Build All‚Äù from the right-click menu of the main <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> file.</p>
<figure class="align-default">
<img alt="Select" src="_images/linux-vscode-cmake-configure.png" />
</figure>
<p>To enable debugging, select the Run/Debug panel in Visual Studio Code. You will now need to create a debugging configuration.
Click the ‚ÄúGear‚Äù icon to edit the file launch.json, and enter the following:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0.2.0&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;configurations&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cppdbg&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;request&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;launch&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Chapter2&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;program&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;${workspaceFolder}/build/Chapter2/Chapter2&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;cwd&quot;</span><span class="p">:</span><span class="s2">&quot;${workspaceFolder}/Chapter2&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;externalConsole&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="android docutils container" id="android-id-6">
<p>With all the source and build systems set up, we can now build the Android project. In upper right of Android Studio, you should find the toolbar below. Click the green hammer icon to build the project, if all is successful you should see ‚ÄúBUILD SUCCESSFUL in [‚Ä¶]s‚Äù in the Build Output window.
It is also recommended to sync the gradle files too.</p>
<p>Next to the green hammer icon is the Run/Debug configuration dropdown menu. If that isn‚Äôt populated, create a configuration called app.</p>
<p>Turn on and connect your Android device. Set up any requirements for USB debugging and adb. You device should appear in the dropdown. Here, I am using a Oculus Quest 2.</p>
<figure class="align-default">
<img alt="Build/Run Toolbar" src="_images/android-studio-build-run-toolbar.png" />
</figure>
<p>To debug/run the application click the green bug icon.</p>
</div>
<p>Now that we have a basic application up and running with the OpenXR header files and libraries, we can start to set up the core aspects of OpenXR. As a modern Khronos API, the OpenXR is heavily influcencd by the Vulkan API. So those who are familiar with the style of the Vulkan API will find OpenXR easy to follow.</p>
</section>
</section>
</section>


						</div>
					</div>
					<footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="OpenXR Tutorial" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="2-setup.html" class="btn btn-neutral float-right" title="‚öôÔ∏è 2 Setup" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr>

  <div role="contentinfo">
    <p>&#169; Copyright &#34;OpenXR&#34; and the OpenXR logo are trademarks owned by The Khronos Group Inc. and are registered as a trademark in China, the European Union, Japan and the United Kingdom.</p>
  </div> 

</footer>
				</div>
			</div>
		</div>
	</div>
  <script></script> 

</body>
</html>