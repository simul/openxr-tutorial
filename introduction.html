<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
	<meta charset="utf-8"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>1. Introduction &mdash; OpenXR Tutorial  documentation</title>
	<link rel="stylesheet" href="_static/pygments.css" type="text/css">
	<link rel="stylesheet" href="_static/css/theme.css" type="text/css">
	<link rel="shortcut icon" href="_static/favicon.ico">
	<!--[if lt IE 9]>
	  <script src="_static/js/html5shiv.min.js"></script>
	<![endif]-->
	
	<script src="_static/jquery.js"></script>
	<script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
	<script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
	<script src="_static/doctools.js"></script>
	<script src="_static/sphinx_highlight.js"></script>
	<script src="https://unpkg.com/mermaid@9.4.0/dist/mermaid.min.js"></script>
	<script>mermaid.initialize({startOnLoad:true});</script>
	<script src="_static/js/theme.js"></script>
	<link rel="index" title="Index" href="genindex.html" >
	<link rel="search" title="Search" href="search.html" >
	<link rel="next" title="2. Setup" href="setup.html" >
	<link rel="prev" title="OpenXR Tutorial" href="index.html" > 
	<script  src="_static/js/js.cookie.min.js"></script>
	<script >
	function updatePlatform()
	{
	var platform = Cookies.get("platform")
	console.log("platform = " + platform);
	if (platform == "windows") {
	$(".linux").hide();
	$(".android").hide();
	$(".windows").show();
	$(".windows-linux").show();
	}
	if (platform == "linux") {
	$(".linux").show();
	$(".android").hide();
	$(".windows").hide();
	$(".windows-linux").show();
	}
	if (platform == "android") {
	$(".linux").hide();
	$(".android").show();
	$(".windows").hide();
	$(".windows-linux").hide();
	}
	window.updatePlatform=updatePlatform;
	}</script>
	<script >
	var platform = Cookies.get("platform")
	if (platform==undefined) {
	Cookies.set('platform', 'windows',{ expires: 365})
	platform='windows';
	}
	</script>
	<script defer>
		updatePlatform();
	</script>
</head>

<body class="wy-body-for-nav" onload="updatePlatform();"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
			<a href="index.html"  class="" >
				<img src="_static/OpenXR_500px_Feb17.png" class="logo" alt="The OpenXR logo" >
				
				<span class="sidebartitle">
					Tutorial
				</span>
				
			</a>
<div role="search">
    <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
        <label class="search-label" for="q">Search the tutorial</label>
        <input type="text" name="q" id="q" placeholder="Search..." aria-label="Search docs">
        <input type="hidden" name="check_keywords" value="yes">
        <input type="hidden" name="area" value="default">
    </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">1. Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#goal-of-openxr">1.1. Goal of OpenXR</a></li>
<li class="toctree-l2"><a class="reference internal" href="#overview">1.2. Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-up">1.3. Setting Up</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pcvr-windows">1.3.1. PCVR: Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pcvr-linux">1.3.2. PCVR: Linux</a></li>
<li class="toctree-l3"><a class="reference internal" href="#android-vr">1.3.3. Android VR</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">2. Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="graphics.html">3. Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="actions.html">4. Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="extensions.html">5. Extensions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <div data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">OpenXR Tutorial</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">1. </span>Introduction</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/introduction.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="introduction">
<h1><span class="section-number">1. </span>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h1>
<ol class="arabic simple">
<li><p>INTRO (understanding &amp; dev env)</p></li>
</ol>
<section id="goal-of-openxr">
<h2><span class="section-number">1.1. </span>Goal of OpenXR<a class="headerlink" href="#goal-of-openxr" title="Permalink to this heading">¶</a></h2>
<p>What is the goal of OpenXR?</p>
</section>
<section id="overview">
<h2><span class="section-number">1.2. </span>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h2>
<p>1.2. High Level overview of the components of OpenXR (Application - Loader - API
layers - Runtime - Graphics - Input System)</p>
</section>
<section id="setting-up">
<h2><span class="section-number">1.3. </span>Setting Up<a class="headerlink" href="#setting-up" title="Permalink to this heading">¶</a></h2>
<p>This section will help you set up a development environment.
( Visual Studio &amp; Android Studio &amp; Monado for people without HMDs )</p>
<p>The exact procedure will depend on your target platform. So first, let’s choose this:</p>
<p>Select which platform you want to develop for, and click the button to show the instructions for that platform.</p>
<div class="windows docutils container" id="windows-intro-1">
<blockquote>
<div><p class="rubric">Windows</p>
<p>You’ll see instructions to build for Windows.</p>
</div></blockquote>
</div>
<div class="linux docutils container" id="linux-intro-1">
<blockquote>
<div><p class="rubric">Linux</p>
<p>You’ll see instructions to build for Linux.</p>
</div></blockquote>
</div>
<div class="android docutils container" id="id1">
<blockquote>
<div><p class="rubric">Android</p>
<p>You’ll see instructions to build for Android.</p>
</div></blockquote>
</div>
<section id="pcvr-windows">
<h3><span class="section-number">1.3.1. </span>PCVR: Windows<a class="headerlink" href="#pcvr-windows" title="Permalink to this heading">¶</a></h3>
<p class="rubric">Visual Studio</p>
<p>If you’ll be building an OpenXR project for PC-based devices, we’ll assume you’ll be using Microsoft Visual Studio.
The free Community edition of Visual Studio is available <a class="reference external" href="https://visualstudio.microsoft.com/vs/community/">here</a>.</p>
<p class="rubric">Direct3D</p>
<p>Next you’ll want to choose which Graphics API you’ll be using. Direct3D 11 and 12 are built into the Windows SDK’s.
If you’re using Direct3D, I recommend D3D12, because it supports indexed views: essentially, you can draw both eye views in one call. Vulkan also
supports this.</p>
<p>Whether D3D11 or 12, download and install the latest <a class="reference external" href="https://developer.microsoft.com/en-us/windows/downloads/windows-sdk/">Windows SDK</a>.</p>
<p class="rubric">Vulkan</p>
<p>If you’ll be using Vulkan, download and install the latest <a class="reference external" href="https://www.lunarg.com/vulkan-sdk/">Vulkan SDK</a>. Take a note of the installation location,
as this will be needed later.</p>
<p class="rubric">OpenXR SDK</p>
<p>You’ll need a copy of the OpenXR SDK, which is distributed as a Git repository. If you’re familiar with Git, you can use your preferred command-line or GUI Git tool to get
the SDK from <em>git&#64;github.com:KhronosGroup/OpenXR-SDK.git</em>.
Alternatively, you can download it as a .zip file from <a class="reference external" href="https://github.com/KhronosGroup/OpenXR-SDK">github.com/KhronosGroup/OpenXR-SDK</a>.</p>
<p class="rubric">CMake</p>
<p>The OpenXR SDK is distributed as source code, and you’ll need to build it, using CMake.
CMake is a program that generates project files, such as the .vcxproj and .sln files
that Visual Studio needs.
Install the latest <a class="reference external" href="https://cmake.org/download/">CMake</a>.</p>
<p>Once CMake is installed, click the Windows button, and type “cmake” to find the application Cmake GUI.</p>
<img alt="Find CMake by clicking the Windows icon and typing &quot;cmake&quot;." class="align-right" src="_images/find_cmake.png" />
<p>In the CMake Gui, enter the location of the OpenXR SDK in the top text box, marked “Where is the source code”. Below, in the box marked “Where to
build the binaries”, enter a subdirectory of that folder, called “build”.</p>
<img alt="an image of the CMake GUI, showing that the location of the OpenXR SDK has been entered as the source directory, and that a subdirectory of this, called &quot;build&quot; has been entered as the binary directory." class="align-right" src="_images/cmake-openxrsdk-1.png" />
<p>Click the button below marked “Configure”. A popup will ask if CMake should create the “build” directory. Click “Yes”.
Now a box will appear where you can select a “Generator”. This should default to the version of
Visual Studio you’ve just installed. Click Finish.
Cmake will now configure the project, and a list of variables will appear in red.</p>
<img alt="alternate text" class="align-right" src="_images/cmake-openxrsdk-2.png" />
<p>You shouldn’t have to change any of these variables, but you can if you want. CMake should have
automatically found the installation of the Vulkan SDK that you created previously, and used it to fill in the variables
Vulkan_INCLUDE_DIR, Vulkan_LIBRARY and so on. If not, you can modify these variables
by clicking on the “Value” entries. The values should look like this:</p>
<img alt="The Vulkan variables in CMake GUI should read:    Vulkan_GLSLANG_VALIDATOR_EXECUTABLE C:/VulkanSDK/1.3.239.0/Bin/glslangValidator.exe    Vulkan_GLSLC_EXECUTABLE C:/VulkanSDK/1.3.239.0/Bin/glslc.exe    Vulkan_INCLUDE_DIR C:/VulkanSDK/1.3.239.0/Include    Vulkan_LIBRARY    C:/VulkanSDK/1.3.239.0/Lib/vulkan-1.lib" class="align-right" src="_images/cmake-vulkan-vars.png" />
<p>Obviously, the precise directory will depend on which version of the Vulkan SDK you installed.</p>
<p>Now, we’re going to “Generate” the project files for the OpenXR SDK. Click “Generate”, and CMake GUI should
now read “Generating done” in the output log at the bottom.</p>
<img alt="The Vulkan variables in CMake GUI should read:    Vulkan_GLSLANG_VALIDATOR_EXECUTABLE C:/VulkanSDK/1.3.239.0/Bin/glslangValidator.exe    Vulkan_GLSLC_EXECUTABLE C:/VulkanSDK/1.3.239.0/Bin/glslc.exe    Vulkan_INCLUDE_DIR C:/VulkanSDK/1.3.239.0/Include    Vulkan_LIBRARY    C:/VulkanSDK/1.3.239.0/Lib/vulkan-1.lib" class="align-right" src="_images/cmake-openxrsdk-generate.png" />
<p>Now we can build the SDK. Click “Open Project” in CMake GUI, or navigate to your “build” folder and double-click on
the file “OPENXR.sln”, and Visual Studio will open the solution.</p>
<p>Select “Debug” from the Visual Studio “Solution Configurations” dropdown.</p>
<img alt="In Visual Studio, the Solution Configuration dropdown menu is shown, with &quot;Debug&quot; selected." class="align-right" src="_images/visual-studio-openxr-debug.png" />
<p>Go to the Build menu and select “Build Solution”. The projects will be compiled, and the output
from openxr_loader.vcxproj should be a library called openxr_loaderd.lib.</p>
<img alt="In Visual Studio, the &quot;Build&quot; menu is shown, with the &quot;Build Solution&quot; option selected." class="align-right" src="_images/visual-studio-openxr-build.png" />
<p>Now repeat the process for the Release build. Select “Release” from the Configurations dropdown,
amd build the solution. This time, the library openxr_loader.lib will be built.</p>
<p>You can now close this solution, you’re ready to start creating your first OpenXR project.</p>
</section>
<section id="pcvr-linux">
<h3><span class="section-number">1.3.2. </span>PCVR: Linux<a class="headerlink" href="#pcvr-linux" title="Permalink to this heading">¶</a></h3>
<p class="rubric">Visual Studio Code</p>
<p>…</p>
<p class="rubric">OpenXR SDK</p>
<p>You’ll need a copy of the OpenXR SDK, which is distributed as a Git repository. If you’re familiar with Git, you can use your preferred command-line or GUI Git tool to get
the SDK from <em>git&#64;github.com:KhronosGroup/OpenXR-SDK.git</em>.</p>
<p>In the downloaded repo, you’ll find a file called README.md, which contains up-to-date instructions
for building the libraries. So follow these instructions in the <em>Linux</em> section. In
general, you will first want to install the required packages, which at the time of writing were:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>build-essential
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>cmake
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>libgl1-mesa-dev
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>libvulkan-dev
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>libx11-xcb-dev
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>libxcb-dri2-0-dev
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>libxcb-glx0-dev
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>libxcb-icccm4-dev
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>libxcb-keysyms1-dev
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>libxcb-randr0-dev
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>libxrandr-dev
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>libxxf86vm-dev
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>mesa-common-dev
</pre></div>
</div>
<p>From the OpenXR-SDK directory,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>-p<span class="w"> </span>build/linux_debug
<span class="nb">cd</span><span class="w"> </span>build/linux_debug
cmake<span class="w"> </span>-DCMAKE_BUILD_TYPE<span class="o">=</span>Debug<span class="w"> </span>../..
make
</pre></div>
</div>
<p>Now return to the OpenXR-SDK directory, and build the release library:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>-p<span class="w"> </span>build/linux_release
<span class="nb">cd</span><span class="w"> </span>build/linux_release
cmake<span class="w"> </span>-DCMAKE_BUILD_TYPE<span class="o">=</span>Release<span class="w"> </span>../..
make
</pre></div>
</div>
<p>This builds libopenxr_loader.so, in Debug and Release flavours, in the directories:
OpenXR-SDK/build/linux_debug/src/loader and OpenXR-SDK/build/linux_release/src/loader.
Both files have the same name on Linux - the debug one is substantially larger however.
And both are <em>dynamic</em> libraries by default, which will be loaded at runtime.</p>
<p>Now you’re ready to start creating your first OpenXR project.</p>
</section>
<section id="android-vr">
<h3><span class="section-number">1.3.3. </span>Android VR<a class="headerlink" href="#android-vr" title="Permalink to this heading">¶</a></h3>
<p class="rubric">Android Studio</p>
<p>Android Studio is available to download here: <a class="reference external" href="https://developer.android.com/studio">https://developer.android.com/studio</a>.</p>
<p class="rubric">OpenXR SDK</p>
<p>For Android, you can download the OpenXR loader libraries from here: <a class="reference external" href="https://github.com/KhronosGroup/OpenXR-SDK-Source/releases/release-1.0.27">https://github.com/KhronosGroup/OpenXR-SDK-Source/releases/release-1.0.27</a>.
Using the .aar file and a program like 7-Zip, you can extract the header files and libraries. Under prefab/modules/openxr_loader/include/openxr, you’ll find the headers, and under prefab/modules/openxr_loader/libs/, you’ll find the libraries for arm64-v8a, armeabi-v7a, x86 and x86_64.</p>
<img alt="7-Zip internal file structure showing the OpenXR headers. prefab/modules/openxr_loader/include/openxr" class="align-right" src="_images/android-7Zip-include.png" />
<img alt="7-Zip internal file structure showing the OpenXR libraries. prefab/modules/openxr_loader/libs" class="align-right" src="_images/android-7Zip-libs.png" />
<p class="rubric">Vulkan</p>
<p>I recommend using Vulkan for Android VR for its modern, low-level API and extension support for multiview. Vulkan is included as part of the NDK provided Google and is supported on Android 7.0 (Nougat), API level 24 or higher. <a class="reference external" href="https://developer.android.com/ndk/guides/graphics">https://developer.android.com/ndk/guides/graphics</a>. OpenGL ES is also option for Android, but we will only be exploring Vulkan.</p>
<p class="rubric">Project Generation</p>
<p>Here, I’ll show how to hand build an Android Studio project that runs a C++ Native Activity.
Open Android Studio, select New Project and choose an Empty Activity. Set the names and save location. The language can be ignored here as we are using C++, and we can set the Minimum SDK to API 24: Android 7.0(Nougat). Complete set up.</p>
<img alt="Android Studio - New Project - Empty Activity." class="align-right" src="_images/android-studio-newproject.png" />
<p class="rubric">CMake</p>
<p>With the Android Studio project now set up, we need to modify some of the files and folders so as to set up the project to support the C++ Native Activity.
Under the <cite>app</cite> folder, you can delete the <cite>libs</cite> folder, and under the <cite>app/src</cite> you can also delete the <cite>androidTest</cite> and <cite>test</cite> folders. Finally under <cite>app/src/main</cite>, delete the <cite>java</cite> folder and add a <cite>cpp</cite> folder. Under the <cite>app/src/main/res</cite>, delete the <cite>values-night</cite> and <cite>xml</cite> folders. Under the <cite>values</cite> modify colors.xml and theme.xml as shown.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!-- colors.xml --&gt;</span>
<span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;resources&gt;</span>
<span class="w">    </span><span class="nt">&lt;color</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;colorPrimary&quot;</span><span class="nt">&gt;</span>#008577<span class="nt">&lt;/color&gt;</span>
<span class="w">    </span><span class="nt">&lt;color</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;colorPrimaryDark&quot;</span><span class="nt">&gt;</span>#00574B<span class="nt">&lt;/color&gt;</span>
<span class="w">    </span><span class="nt">&lt;color</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;colorAccent&quot;</span><span class="nt">&gt;</span>#D81B60<span class="nt">&lt;/color&gt;</span>
<span class="nt">&lt;/resources&gt;</span>

<span class="cm">&lt;!-- theme.xml --&gt;</span>
<span class="nt">&lt;resources&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- Base application theme. --&gt;</span>
<span class="w">    </span><span class="nt">&lt;style</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;AppTheme&quot;</span><span class="w"> </span><span class="na">parent=</span><span class="s">&quot;Theme.AppCompat.Light.DarkActionBar&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="cm">&lt;!-- Customize your theme here. --&gt;</span>
<span class="w">        </span><span class="nt">&lt;item</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;colorPrimary&quot;</span><span class="nt">&gt;</span>@color/colorPrimary<span class="nt">&lt;/item&gt;</span>
<span class="w">        </span><span class="nt">&lt;item</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;colorPrimaryDark&quot;</span><span class="nt">&gt;</span>@color/colorPrimaryDark<span class="nt">&lt;/item&gt;</span>
<span class="w">        </span><span class="nt">&lt;item</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;colorAccent&quot;</span><span class="nt">&gt;</span>@color/colorAccent<span class="nt">&lt;/item&gt;</span>
<span class="w">    </span><span class="nt">&lt;/style&gt;</span>

<span class="nt">&lt;/resources&gt;</span>
</pre></div>
</div>
<p>Within the <cite>app/src/main/cpp</cite> folder, create a CMakeLists.txt. We will use this file to specific how our Native C++ code will be built. This CMakeList will be invoked by Android Studio’s Gradle build system.</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="c"># For more information about using CMake with Android Studio, read the</span>
<span class="c"># documentation: https://d.android.com/studio/projects/add-native-code.html</span>

<span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="s">VERSION</span><span class="w"> </span><span class="s">3.22.1</span><span class="p">)</span>
<span class="nb">project</span><span class="p">(</span><span class="s2">&quot;openxrtutorialch2_1&quot;</span><span class="p">)</span>

<span class="c"># native_app_glue</span>
<span class="nb">add_library</span><span class="p">(</span><span class="s">native_app_glue</span><span class="w"> </span><span class="s">STATIC</span><span class="w"> </span><span class="o">${</span><span class="nv">ANDROID_NDK</span><span class="o">}</span><span class="s">/sources/android/native_app_glue/android_native_app_glue.c</span><span class="p">)</span>
<span class="nb">target_include_directories</span><span class="p">(</span><span class="s">native_app_glue</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="o">${</span><span class="nv">ANDROID_NDK</span><span class="o">}</span><span class="s">/sources/android/native_app_glue</span><span class="p">)</span>

<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_SHARED_LINKER_FLAGS</span><span class="w"> </span><span class="s2">&quot;${CMAKE_SHARED_LINKER_FLAGS} -u ANativeActivity_onCreate&quot;</span><span class="p">)</span><span class="w"> </span><span class="c"># export ANativeActivity_onCreate for java to call.</span>
<span class="nb">add_library</span><span class="p">(</span><span class="s">openxrtutorialch2_1</span><span class="w"> </span><span class="s">SHARED</span><span class="w"> </span><span class="s">../../../../../Chapter2.1/main.cpp</span><span class="p">)</span>

<span class="c"># import openxr_loader</span>
<span class="nb">add_library</span><span class="p">(</span><span class="s">openxr_loader</span><span class="w"> </span><span class="s">SHARED</span><span class="w"> </span><span class="s">IMPORTED</span><span class="p">)</span>
<span class="nb">set_target_properties</span><span class="p">(</span><span class="s">openxr_loader</span><span class="w"> </span><span class="s">PROPERTIES</span><span class="w"> </span><span class="s">IMPORTED_LOCATION</span><span class="w"> </span><span class="s2">&quot;../../../../../../thirdparty/openxr-sdk/android/libs/android.arm64-v8a/libopenxr_loader.so&quot;</span><span class="p">)</span>
<span class="nb">target_include_directories</span><span class="p">(</span><span class="s">openxrtutorialch2_1</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="s">../../../../../thirdparty/openxr-sdk/include</span><span class="p">)</span>

<span class="c"># vulkan - Found in the NDK</span>
<span class="nb">find_library</span><span class="p">(</span><span class="s">vulkan-lib</span><span class="w"> </span><span class="s">vulkan</span><span class="p">)</span>
<span class="nb">target_include_directories</span><span class="p">(</span><span class="s">openxrtutorialch2_1</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="o">${</span><span class="nv">ANDROID_NDK</span><span class="o">}</span><span class="s">/sources/third_party/vulkan/src/include</span><span class="p">)</span>

<span class="c"># log - Found in the NDK</span>
<span class="nb">find_library</span><span class="p">(</span><span class="s">log-lib</span><span class="w"> </span><span class="s">log</span><span class="p">)</span>

<span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">openxrtutorialch2_1</span>
<span class="w">        </span><span class="s">android</span>
<span class="w">        </span><span class="s">native_app_glue</span>
<span class="w">        </span><span class="s">openxr_loader</span>
<span class="w">        </span><span class="o">${</span><span class="nv">vulkan-lib</span><span class="o">}</span>
<span class="w">        </span><span class="o">${</span><span class="nv">log-lib</span><span class="o">}</span><span class="p">)</span>
</pre></div>
</div>
<p>First, we set the minimum required cmake version, here we are using 3.22.1 and the project’s name. Next, we need to add a static library called native_app_glue. The native_app_glue library is compiled from a single source file android_native_app_glue.c. This interfaces between the Java Virtual Machine and our C++ code. Ultimately, it allows us to use the <cite>void android_main(struct android_app*)</cite> entry point. We also include that directory as we need access to the android_native_app_glue.h header file. Next, we need to set the <cite>CMAKE_SHARED_LINKER_FLAGS</cite> so that <cite>ANativeActivity_onCreate()</cite> is exported for the Java Virtual Machine to call. Next, we add our shared library openxrtutorialch2_1 that houses our code. Here, I have a relative path to our single C++ file.</p>
<p>Now, we import the openxr_loader library. We need to do this, because it’s external to the NDK library, and won’t be automatically picked up. We call <cite>set_target_properties()</cite> to specific the location of libopenxr_loader.so. We also include the directory to the OpenXR headers. Next, we find the Vulkan library in the NDK and include the directory to the Android Vulkan headers. At this time, we also find the log library. Finally we link the android, native_app_glue, openxr_loader, vulkan and log libraries to our openxrtutorialch2_1 library. Our libopenxrtutorialch2_1.so will packageed inside our apk along with any shared libraries that we have linked.</p>
<p class="rubric">AndroidManifest.xml</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;manifest</span><span class="w"> </span><span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
<span class="w">    </span><span class="na">package=</span><span class="s">&quot;com.simul.openxrtutorialch2_1&quot;</span>
<span class="w">    </span><span class="na">android:versionCode=</span><span class="s">&quot;1&quot;</span>
<span class="w">    </span><span class="na">android:versionName=</span><span class="s">&quot;1.0&quot;</span><span class="nt">&gt;</span>

<span class="w">    </span><span class="nt">&lt;application</span>
<span class="w">        </span><span class="na">android:allowBackup=</span><span class="s">&quot;false&quot;</span>
<span class="w">        </span><span class="na">android:fullBackupContent=</span><span class="s">&quot;false&quot;</span>
<span class="w">        </span><span class="na">android:icon=</span><span class="s">&quot;@mipmap/ic_launcher&quot;</span>
<span class="w">        </span><span class="na">android:label=</span><span class="s">&quot;@string/app_name&quot;</span>
<span class="w">        </span><span class="na">android:hasCode=</span><span class="s">&quot;false&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;activity</span>
<span class="w">            </span><span class="na">android:name=</span><span class="s">&quot;android.app.NativeActivity&quot;</span>
<span class="w">            </span><span class="na">android:configChanges=</span><span class="s">&quot;orientation|keyboardHidden&quot;</span>
<span class="w">            </span><span class="na">android:debuggable=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;meta-data</span>
<span class="w">                </span><span class="na">android:name=</span><span class="s">&quot;android.app.lib_name&quot;</span>
<span class="w">                </span><span class="na">android:value=</span><span class="s">&quot;openxrtutorialch2_1&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>

<span class="w">            </span><span class="nt">&lt;intent-filter&gt;</span>
<span class="w">                </span><span class="nt">&lt;action</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.intent.action.MAIN&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                </span><span class="nt">&lt;category</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.intent.category.LAUNCHER&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;/intent-filter&gt;</span>
<span class="w">        </span><span class="nt">&lt;/activity&gt;</span>
<span class="w">    </span><span class="nt">&lt;/application&gt;</span>
<span class="nt">&lt;/manifest&gt;</span>
</pre></div>
</div>
<p>We now need to modify our AndroidManifest.xml file to tell Android to run a Native Activity. We set <cite>android:name</cite> to “android.app.NativeActivity” and update <cite>android:configChanges</cite> to “orientation|keyboardHidden” to not close the activity on those changes. Next under the meta-data section, we set these values: <cite>android:name</cite> to “android.app.lib_name” and <cite>android:value</cite> to “openxrtutorialch2_1”, where <cite>android:value</cite> is name of the library we created in the CMakeLists, thus pointing our NativeActivity to the correct library.</p>
<p class="rubric">Gradle</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">apply</span><span class="w"> </span><span class="nl">plugin:</span><span class="w"> </span><span class="s1">&#39;com.android.application&#39;</span>

<span class="n">android</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">compileSdkVersion</span><span class="w"> </span><span class="mi">29</span>
<span class="w">    </span><span class="n">ndkVersion</span><span class="w"> </span><span class="s1">&#39;23.1.7779620&#39;</span>

<span class="w">    </span><span class="n">defaultConfig</span><span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="n">applicationId</span><span class="w"> </span><span class="s2">&quot;com.simul.openxrtutorialch2_1&quot;</span>
<span class="w">        </span><span class="n">minSdkVersion</span><span class="w"> </span><span class="mi">29</span>
<span class="w">        </span><span class="n">targetSdkVersion</span><span class="w"> </span><span class="mi">29</span>
<span class="w">        </span><span class="n">versionCode</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="n">versionName</span><span class="w"> </span><span class="s2">&quot;1.0&quot;</span>
<span class="w">        </span><span class="n">ndk</span><span class="w"> </span><span class="o">{</span>
<span class="w">            </span><span class="n">abiFilters</span><span class="w"> </span><span class="s1">&#39;arm64-v8a&#39;</span>
<span class="w">        </span><span class="o">}</span>
<span class="w">    </span><span class="o">}</span>
<span class="w">    </span><span class="n">buildFeatures</span><span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="n">prefab</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="o">}</span>
<span class="w">    </span><span class="n">buildTypes</span><span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="n">release</span><span class="w"> </span><span class="o">{</span>
<span class="w">            </span><span class="n">minifyEnabled</span><span class="w"> </span><span class="kc">false</span>
<span class="w">            </span><span class="n">proguardFiles</span><span class="w"> </span><span class="n">getDefaultProguardFile</span><span class="o">(</span><span class="s1">&#39;proguard-android-optimize.txt&#39;</span><span class="o">),</span><span class="w"> </span><span class="s1">&#39;proguard-rules.pro&#39;</span>
<span class="w">        </span><span class="o">}</span>
<span class="w">        </span><span class="n">debug</span><span class="w"> </span><span class="o">{</span>
<span class="w">            </span><span class="n">jniDebuggable</span><span class="w"> </span><span class="kc">true</span>
<span class="w">            </span><span class="n">debuggable</span><span class="w"> </span><span class="kc">true</span>
<span class="w">            </span><span class="n">renderscriptDebuggable</span><span class="w"> </span><span class="kc">true</span>
<span class="w">            </span><span class="n">minifyEnabled</span><span class="w"> </span><span class="kc">false</span>
<span class="w">        </span><span class="o">}</span>
<span class="w">    </span><span class="o">}</span>
<span class="w">    </span><span class="n">externalNativeBuild</span><span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="n">cmake</span><span class="w"> </span><span class="o">{</span>
<span class="w">            </span><span class="n">version</span><span class="w"> </span><span class="s1">&#39;3.22.1&#39;</span>
<span class="w">            </span><span class="n">path</span><span class="w"> </span><span class="s1">&#39;src/main/cpp/CMakeLists.txt&#39;</span>
<span class="w">        </span><span class="o">}</span>
<span class="w">    </span><span class="o">}</span>
<span class="o">}</span>

<span class="n">dependencies</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">implementation</span><span class="w"> </span><span class="n">fileTree</span><span class="o">(</span><span class="nl">dir:</span><span class="w"> </span><span class="s1">&#39;libs&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">include:</span><span class="w"> </span><span class="o">[</span><span class="s1">&#39;*.jar&#39;</span><span class="o">])</span>
<span class="w">    </span><span class="n">implementation</span><span class="w"> </span><span class="s1">&#39;androidx.appcompat:appcompat:1.0.2&#39;</span>
<span class="w">    </span><span class="n">implementation</span><span class="w"> </span><span class="s1">&#39;androidx.constraintlayout:constraintlayout:1.1.3&#39;</span>
<span class="w">    </span><span class="n">implementation</span><span class="w"> </span><span class="s1">&#39;org.khronos.openxr:openxr_loader_for_android:1.0.27&#39;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Now, we can config our build.gradle file in the <cite>app</cite> folder. First remove any references to Java, Kotlin and to testing. Next add in the <cite>externalNativeBuild</cite> section specifying CMake, its version and the location of the CMakeLists.txt that we created earlier. Also specify under the <cite>ndk</cite> section the <cite>abiFilters</cite>. We will just be using arm64-v8a in this tutorial. <cite>ndkVersion</cite> should also be specified.</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="c1">// Top-level build file where you can add configuration options common to all sub-projects/modules.</span>
<span class="n">buildscript</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">repositories</span><span class="w"> </span><span class="o">{</span>
<span class="w">       </span><span class="n">google</span><span class="o">()</span>
<span class="w">       </span><span class="n">mavenCentral</span><span class="o">()</span>
<span class="w">    </span><span class="o">}</span>
<span class="w">    </span><span class="n">dependencies</span><span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="n">classpath</span><span class="w"> </span><span class="s1">&#39;com.android.tools.build:gradle:4.2.2&#39;</span>
<span class="w">    </span><span class="o">}</span>
<span class="o">}</span>

<span class="n">allprojects</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">repositories</span><span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="n">google</span><span class="o">()</span>
<span class="w">        </span><span class="n">mavenCentral</span><span class="o">()</span>
<span class="w">    </span><span class="o">}</span>
<span class="o">}</span>

<span class="n">task</span><span class="w"> </span><span class="nf">clean</span><span class="o">(</span><span class="nl">type:</span><span class="w"> </span><span class="n">Delete</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">delete</span><span class="w"> </span><span class="n">rootProject</span><span class="o">.</span><span class="na">buildDir</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Now, we can config our build.gradle file in the root folder of the project. This is a complete replacement the default one provided by Android Studio. This file stipulates the repositories and gradle version to be used.
The settings.gradle can be reduce to just: <cite>include ‘:app’</cite>, and in the gradle.properties we need to remove <cite>kotlin.code.style=official</cite> and <cite>android.nonTransitiveRClass=true</cite>.</p>
<p>With that completed, we should now be able to sync the Gradle file and build the project.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="OpenXR Tutorial" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="setup.html" class="btn btn-neutral float-right" title="2. Setup" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr>

  <div role="contentinfo">
    <p>&#169; Copyright &#34;OpenXR&#34; and the OpenXR logo are trademarks owned by The Khronos Group Inc. and are registered as a trademark in China, the European Union, Japan and the United Kingdom.</p>
  </div> 

</footer>
        </div>
      </div>
    </div>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>